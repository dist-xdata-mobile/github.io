(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{568:function(s,a,t){"use strict";t.r(a);var e=t(6),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"harbor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#harbor"}},[s._v("#")]),s._v(" Harbor")]),s._v(" "),t("blockquote",[t("p",[s._v("万世威\n2020-10-16")])]),s._v(" "),t("h3",{attrs:{id:"参考手册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考手册"}},[s._v("#")]),s._v(" 参考手册")]),s._v(" "),t("p",[s._v("https://goharbor.io/docs/2.0.0/install-config/")]),s._v(" "),t("h3",{attrs:{id:"安装步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装步骤"}},[s._v("#")]),s._v(" 安装步骤")]),s._v(" "),t("p",[s._v("1、软硬件版本要求")]),s._v(" "),t("p",[s._v("https://goharbor.io/docs/2.0.0/install-config/installation-prereqs/")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("Docker engine")]),s._v(" "),t("th",[s._v("Version 17.06.0-ce+ or higher")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("Docker Compose")]),s._v(" "),t("td",[s._v("Version 1.18.0 or higher")])])])]),s._v(" "),t("p",[s._v("升级 Docker 版本")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/weixin_43941364/article/details/106406185")]),s._v(" "),t("p",[s._v("安装 Docker-compose")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.18.0/docker-compose-'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/local/bin/docker-compose\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("2、下载安装包")]),s._v(" "),t("ul",[t("li",[s._v("在线版")]),s._v(" "),t("li",[s._v("离线版")])]),s._v(" "),t("p",[s._v("https://github.com/goharbor/harbor/releases")]),s._v(" "),t("p",[s._v("3、配置 Harbor 的 yaml 文件")]),s._v(" "),t("p",[s._v("https://goharbor.io/docs/2.0.0/install-config/configure-yml-file/")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" x.x.x.x "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不要使用 localhost、127.0.0.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注释掉 HTTPS 相关内容")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("4、启动")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" install.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"推送镜像到仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送镜像到仓库"}},[s._v("#")]),s._v(" 推送镜像到仓库")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、docker 配置文件中添加以下 配置 并重启")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"insecure-registries"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.2.163"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、先本地登录一次，生成配置信息[不然不知道用户信息，推送会失败]")]),s._v("\ndocker login ip:port\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、创建 tag，docker push 192.168.2.163/test/IMAGE[:TAG]")]),s._v("\ndocker tag portainer/portainer "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.163/test/portainer\ndocker push "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.163/test/portainer\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[s._v("#")]),s._v(" 问题")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?")]),s._v("\nsystemctl start docker\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The protocol is https but attribute ssl_cert is not set")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注释掉 yaml 中 https 相关内容")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mac 上部署，需要在 harbor.yml 、docker-post.yml 中调整部分配置【权限问题导致】")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for example：/var/log/harbor")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);