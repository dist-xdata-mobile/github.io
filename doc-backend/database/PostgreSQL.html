<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostgreSQL | Fellow Travellers</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <meta name="description" content="Fellow-Travellers documents for tech3D / mobile / calc / back-end">
    <link rel="preload" href="/assets/css/0.styles.d4a3a82a.css" as="style"><link rel="preload" href="/assets/js/app.16cdc938.js" as="script"><link rel="preload" href="/assets/js/3.4f14b16d.js" as="script"><link rel="preload" href="/assets/js/1.02cf7ae9.js" as="script"><link rel="preload" href="/assets/js/32.6baff7b9.js" as="script"><link rel="prefetch" href="/assets/js/10.f5269c4e.js"><link rel="prefetch" href="/assets/js/100.c7e247ff.js"><link rel="prefetch" href="/assets/js/101.b60225bc.js"><link rel="prefetch" href="/assets/js/102.adacab9e.js"><link rel="prefetch" href="/assets/js/103.32cd0f3b.js"><link rel="prefetch" href="/assets/js/104.1fd9ea1d.js"><link rel="prefetch" href="/assets/js/105.5bfce959.js"><link rel="prefetch" href="/assets/js/106.44ca9c1d.js"><link rel="prefetch" href="/assets/js/107.9ee3fdbe.js"><link rel="prefetch" href="/assets/js/108.2e6ba386.js"><link rel="prefetch" href="/assets/js/109.12b4497c.js"><link rel="prefetch" href="/assets/js/11.9161989f.js"><link rel="prefetch" href="/assets/js/110.d255fdda.js"><link rel="prefetch" href="/assets/js/111.64c62930.js"><link rel="prefetch" href="/assets/js/112.6a427f04.js"><link rel="prefetch" href="/assets/js/113.5ec41ed5.js"><link rel="prefetch" href="/assets/js/114.d289af71.js"><link rel="prefetch" href="/assets/js/115.b052778b.js"><link rel="prefetch" href="/assets/js/116.f20d5acd.js"><link rel="prefetch" href="/assets/js/117.759b608c.js"><link rel="prefetch" href="/assets/js/118.a00460b4.js"><link rel="prefetch" href="/assets/js/119.021cbb12.js"><link rel="prefetch" href="/assets/js/12.e1aacb47.js"><link rel="prefetch" href="/assets/js/120.5bd8b71f.js"><link rel="prefetch" href="/assets/js/121.3e722ff2.js"><link rel="prefetch" href="/assets/js/122.a825e6c4.js"><link rel="prefetch" href="/assets/js/123.ff402ce6.js"><link rel="prefetch" href="/assets/js/124.287761b7.js"><link rel="prefetch" href="/assets/js/125.b4048370.js"><link rel="prefetch" href="/assets/js/126.bef086fd.js"><link rel="prefetch" href="/assets/js/127.a0784eab.js"><link rel="prefetch" href="/assets/js/128.66f3cbc1.js"><link rel="prefetch" href="/assets/js/129.aef33c57.js"><link rel="prefetch" href="/assets/js/13.faee7a70.js"><link rel="prefetch" href="/assets/js/130.0fbb1019.js"><link rel="prefetch" href="/assets/js/131.61f2146b.js"><link rel="prefetch" href="/assets/js/132.3d912bd8.js"><link rel="prefetch" href="/assets/js/133.b688ed34.js"><link rel="prefetch" href="/assets/js/134.59d26e48.js"><link rel="prefetch" href="/assets/js/135.2d1de6ca.js"><link rel="prefetch" href="/assets/js/136.82c509c1.js"><link rel="prefetch" href="/assets/js/137.aa6f5b18.js"><link rel="prefetch" href="/assets/js/138.8f50bb93.js"><link rel="prefetch" href="/assets/js/139.83f80acb.js"><link rel="prefetch" href="/assets/js/14.5e1b322f.js"><link rel="prefetch" href="/assets/js/140.255a8042.js"><link rel="prefetch" href="/assets/js/141.a7ad537d.js"><link rel="prefetch" href="/assets/js/142.b0c92d9c.js"><link rel="prefetch" href="/assets/js/143.f15b1f80.js"><link rel="prefetch" href="/assets/js/144.813a5a2e.js"><link rel="prefetch" href="/assets/js/145.b7069ddf.js"><link rel="prefetch" href="/assets/js/146.9fcc40e8.js"><link rel="prefetch" href="/assets/js/147.654c12e8.js"><link rel="prefetch" href="/assets/js/148.d2104b86.js"><link rel="prefetch" href="/assets/js/149.16115bff.js"><link rel="prefetch" href="/assets/js/15.c64a0296.js"><link rel="prefetch" href="/assets/js/150.e19d3aa4.js"><link rel="prefetch" href="/assets/js/151.e1e9732d.js"><link rel="prefetch" href="/assets/js/152.e4d9ed7c.js"><link rel="prefetch" href="/assets/js/153.720bddec.js"><link rel="prefetch" href="/assets/js/154.6d76f159.js"><link rel="prefetch" href="/assets/js/155.56639bb5.js"><link rel="prefetch" href="/assets/js/156.1b1456ad.js"><link rel="prefetch" href="/assets/js/157.41735b3f.js"><link rel="prefetch" href="/assets/js/158.2f7e2a71.js"><link rel="prefetch" href="/assets/js/159.8ecf5123.js"><link rel="prefetch" href="/assets/js/16.f13c1a4b.js"><link rel="prefetch" href="/assets/js/160.dd6f3d5e.js"><link rel="prefetch" href="/assets/js/161.ba4d9a7f.js"><link rel="prefetch" href="/assets/js/162.297aea0d.js"><link rel="prefetch" href="/assets/js/163.e34450b7.js"><link rel="prefetch" href="/assets/js/164.34381886.js"><link rel="prefetch" href="/assets/js/165.d4c2775d.js"><link rel="prefetch" href="/assets/js/166.c4c9cefb.js"><link rel="prefetch" href="/assets/js/167.d323a0a9.js"><link rel="prefetch" href="/assets/js/168.c20012b9.js"><link rel="prefetch" href="/assets/js/169.3cfddb83.js"><link rel="prefetch" href="/assets/js/17.e99ac461.js"><link rel="prefetch" href="/assets/js/170.3d3526f6.js"><link rel="prefetch" href="/assets/js/171.bba7cce9.js"><link rel="prefetch" href="/assets/js/172.8fbda3bd.js"><link rel="prefetch" href="/assets/js/173.1532f8d6.js"><link rel="prefetch" href="/assets/js/174.638e5e0a.js"><link rel="prefetch" href="/assets/js/175.d8d82e12.js"><link rel="prefetch" href="/assets/js/176.4b3a122c.js"><link rel="prefetch" href="/assets/js/177.3d9e6e89.js"><link rel="prefetch" href="/assets/js/178.58b1bf9b.js"><link rel="prefetch" href="/assets/js/179.3fc5f21a.js"><link rel="prefetch" href="/assets/js/18.2df0d7da.js"><link rel="prefetch" href="/assets/js/180.436cb2b1.js"><link rel="prefetch" href="/assets/js/181.dadcbdd8.js"><link rel="prefetch" href="/assets/js/182.d7f00bd5.js"><link rel="prefetch" href="/assets/js/183.b6a49ebe.js"><link rel="prefetch" href="/assets/js/184.72f1e1df.js"><link rel="prefetch" href="/assets/js/185.a30e0b04.js"><link rel="prefetch" href="/assets/js/186.a89aa666.js"><link rel="prefetch" href="/assets/js/187.c7601a79.js"><link rel="prefetch" href="/assets/js/188.47d25cdd.js"><link rel="prefetch" href="/assets/js/189.a5220877.js"><link rel="prefetch" href="/assets/js/19.74c2fe85.js"><link rel="prefetch" href="/assets/js/190.7fea63c8.js"><link rel="prefetch" href="/assets/js/191.79188b69.js"><link rel="prefetch" href="/assets/js/192.91858bc5.js"><link rel="prefetch" href="/assets/js/193.f8c9dc11.js"><link rel="prefetch" href="/assets/js/194.db5d514f.js"><link rel="prefetch" href="/assets/js/195.a21dfa21.js"><link rel="prefetch" href="/assets/js/196.3deca662.js"><link rel="prefetch" href="/assets/js/197.a26c6a57.js"><link rel="prefetch" href="/assets/js/198.199de2a9.js"><link rel="prefetch" href="/assets/js/199.3a93f5fd.js"><link rel="prefetch" href="/assets/js/20.37ef7b5a.js"><link rel="prefetch" href="/assets/js/200.2e0ca284.js"><link rel="prefetch" href="/assets/js/201.43159287.js"><link rel="prefetch" href="/assets/js/202.47ac18b9.js"><link rel="prefetch" href="/assets/js/21.8edf360c.js"><link rel="prefetch" href="/assets/js/22.681f9ff8.js"><link rel="prefetch" href="/assets/js/23.102f38f3.js"><link rel="prefetch" href="/assets/js/24.0d068097.js"><link rel="prefetch" href="/assets/js/25.b8c6fba0.js"><link rel="prefetch" href="/assets/js/26.b76fcccf.js"><link rel="prefetch" href="/assets/js/27.b95d8356.js"><link rel="prefetch" href="/assets/js/28.425d53a0.js"><link rel="prefetch" href="/assets/js/29.49ae4d56.js"><link rel="prefetch" href="/assets/js/30.268326de.js"><link rel="prefetch" href="/assets/js/31.d1322ccd.js"><link rel="prefetch" href="/assets/js/33.91599495.js"><link rel="prefetch" href="/assets/js/34.7d1e8694.js"><link rel="prefetch" href="/assets/js/35.a28b2867.js"><link rel="prefetch" href="/assets/js/36.926c21b7.js"><link rel="prefetch" href="/assets/js/37.00738964.js"><link rel="prefetch" href="/assets/js/38.c07a024e.js"><link rel="prefetch" href="/assets/js/39.23ab4214.js"><link rel="prefetch" href="/assets/js/4.79366a86.js"><link rel="prefetch" href="/assets/js/40.47c89362.js"><link rel="prefetch" href="/assets/js/41.0e9b77b3.js"><link rel="prefetch" href="/assets/js/42.e93c36a9.js"><link rel="prefetch" href="/assets/js/43.8e4bef73.js"><link rel="prefetch" href="/assets/js/44.f5808021.js"><link rel="prefetch" href="/assets/js/45.3afe2dae.js"><link rel="prefetch" href="/assets/js/46.f597a77f.js"><link rel="prefetch" href="/assets/js/47.11f2d487.js"><link rel="prefetch" href="/assets/js/48.7fef6ef8.js"><link rel="prefetch" href="/assets/js/49.b2d21efe.js"><link rel="prefetch" href="/assets/js/5.9ee91412.js"><link rel="prefetch" href="/assets/js/50.5832583c.js"><link rel="prefetch" href="/assets/js/51.54c00e7a.js"><link rel="prefetch" href="/assets/js/52.bd5535f0.js"><link rel="prefetch" href="/assets/js/53.0d38f84a.js"><link rel="prefetch" href="/assets/js/54.65144b95.js"><link rel="prefetch" href="/assets/js/55.368817a9.js"><link rel="prefetch" href="/assets/js/56.04e15523.js"><link rel="prefetch" href="/assets/js/57.b41a7dc6.js"><link rel="prefetch" href="/assets/js/58.0f0d92dd.js"><link rel="prefetch" href="/assets/js/59.e7dddc9e.js"><link rel="prefetch" href="/assets/js/6.b921ef33.js"><link rel="prefetch" href="/assets/js/60.4038bd0b.js"><link rel="prefetch" href="/assets/js/61.5d51e956.js"><link rel="prefetch" href="/assets/js/62.786b095c.js"><link rel="prefetch" href="/assets/js/63.9da19a49.js"><link rel="prefetch" href="/assets/js/64.48f50f07.js"><link rel="prefetch" href="/assets/js/65.0fd7ee4a.js"><link rel="prefetch" href="/assets/js/66.5d68a363.js"><link rel="prefetch" href="/assets/js/67.f4882da2.js"><link rel="prefetch" href="/assets/js/68.224daefc.js"><link rel="prefetch" href="/assets/js/69.420801b1.js"><link rel="prefetch" href="/assets/js/7.e128bbee.js"><link rel="prefetch" href="/assets/js/70.1e62f96f.js"><link rel="prefetch" href="/assets/js/71.62f9fa7c.js"><link rel="prefetch" href="/assets/js/72.ad20df74.js"><link rel="prefetch" href="/assets/js/73.e16fef7c.js"><link rel="prefetch" href="/assets/js/74.c1f72d12.js"><link rel="prefetch" href="/assets/js/75.e1f28980.js"><link rel="prefetch" href="/assets/js/76.2c304c87.js"><link rel="prefetch" href="/assets/js/77.7265d1f0.js"><link rel="prefetch" href="/assets/js/78.c7c2fdd3.js"><link rel="prefetch" href="/assets/js/79.0be55b5d.js"><link rel="prefetch" href="/assets/js/8.b17d0b27.js"><link rel="prefetch" href="/assets/js/80.3c460019.js"><link rel="prefetch" href="/assets/js/81.972b58cd.js"><link rel="prefetch" href="/assets/js/82.6c4d50e0.js"><link rel="prefetch" href="/assets/js/83.89ff3b39.js"><link rel="prefetch" href="/assets/js/84.5629cfb0.js"><link rel="prefetch" href="/assets/js/85.78a9bc3f.js"><link rel="prefetch" href="/assets/js/86.b429e7fb.js"><link rel="prefetch" href="/assets/js/87.5c3ba926.js"><link rel="prefetch" href="/assets/js/88.52737753.js"><link rel="prefetch" href="/assets/js/89.696bb63f.js"><link rel="prefetch" href="/assets/js/9.0874a43d.js"><link rel="prefetch" href="/assets/js/90.60296dbe.js"><link rel="prefetch" href="/assets/js/91.2d2fd4df.js"><link rel="prefetch" href="/assets/js/92.d860f080.js"><link rel="prefetch" href="/assets/js/93.b341ebd9.js"><link rel="prefetch" href="/assets/js/94.ebd37258.js"><link rel="prefetch" href="/assets/js/95.15dbfc06.js"><link rel="prefetch" href="/assets/js/96.041d049b.js"><link rel="prefetch" href="/assets/js/97.e22ed305.js"><link rel="prefetch" href="/assets/js/98.2e23ad42.js"><link rel="prefetch" href="/assets/js/99.e886cd85.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4a3a82a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar shadow"><div class="con-btns-header"><a href="/" class="home-link router-link-active"><div class="con-logo"><!----> <span class="site-name">Fellow Travellers</span></div></a> <div class="links"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link" data-v-e7cf42d2>主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">三维</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-tech3d/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/language/Micro-frontend_Start.html" class="nav-link" data-v-e7cf42d2>开发语言</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/production/" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/codelab/Principle_of_Visualizatio_for_WebGL.html" class="nav-link" data-v-e7cf42d2>专题</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/other/SuperMap_Questions_and_Answer.html" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-frontend/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/base/EC_ScopChain_Closure.html" class="nav-link" data-v-e7cf42d2>开发基础</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/web-gis/" class="nav-link" data-v-e7cf42d2>WebGIS开发</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/solution/" class="nav-link" data-v-e7cf42d2>解决方案</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/best-practice/" class="nav-link" data-v-e7cf42d2>最佳实践</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/arithmetic/QuickSort.html" class="nav-link" data-v-e7cf42d2>算法</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">移动</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-mobile/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/dataResource/sourceCodeLib.html" class="nav-link" data-v-e7cf42d2>数据资源</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/product/nativeApp.html" class="nav-link" data-v-e7cf42d2>产品分型</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/appStore/" class="nav-link" data-v-e7cf42d2>应用商店</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/other/designDocument.html" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-calc3d/start/XinShouShouCe.html" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/gis/Base_ZBX_ZongJie.html" class="nav-link" data-v-e7cf42d2>GIS</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/database/Oracle_LostSysPassword.html" class="nav-link" data-v-e7cf42d2>数据库</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/language/" class="nav-link" data-v-e7cf42d2>开发语言</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/codelab/" class="nav-link" data-v-e7cf42d2>源码库</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/production/DDP_ArcGIS_BuShuShouCe.html" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后台</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-backend/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/database/Mongoazyx.html" class="nav-link" data-v-e7cf42d2>数据库</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/framework/Git.html" class="nav-link" data-v-e7cf42d2>开发基础</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/production/" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础研发</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-base/dist-utils/API.html" class="nav-link" data-v-e7cf42d2>dist-utils</a></li><li class="dropdown-item"><!----> <a href="http://192.168.200.39:18088/EyeMapAPI/" target="_blank" rel="noopener noreferrer" class="nav-link" data-v-e7cf42d2>eyemap业务库</a></li><li class="dropdown-item"><!----> <a href="/doc-base/stylelint-config/" class="nav-link" data-v-e7cf42d2>stylelint-config</a></li></ul></div></div><div class="nav-item"><a href="/doc-share/SuperMap_Pipe3DStrategy.html" class="nav-link" data-v-e7cf42d2>分享</a></div><div class="nav-item"><a href="https://fellowtravellers.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link" data-v-e7cf42d2>社区</a></div><div class="nav-item"><a href="/doc-help/mdRule.html" class="nav-link" data-v-e7cf42d2>帮助</a></div></nav></div></div> <div class="con-redes-download"><a title="GitLab" href="http://elb-791125809.cn-northwest-1.elb.amazonaws.com.cn:5335/" target="_blank" rel="noopener noreferrer" class="repo-link flaticon-github"></a></div></header> <div class="sidebar-map"><div class="c-sidebar-map"><ul class="sidebar-links-map"><li><div class="sidebar-group first"><ul class="sidebar-group-items"><li><a href="/doc-backend/database/Mongoazyx.html" class="sidebar-link siderbar-map-item">Mongo安装运行</a></li><li><a href="/doc-backend/database/Mongoccwj.html" class="sidebar-link siderbar-map-item">Mongo存储文件—GridFS</a></li><li><a href="/doc-backend/database/MongoDBjc.html" class="sidebar-link siderbar-map-item">MongoDB基础</a></li><li><a href="/doc-backend/database/MongoDBsy.html" class="sidebar-link siderbar-map-item">MongoDB权限操作</a></li><li><a href="/doc-backend/database/MongoDBzstx.html" class="sidebar-link siderbar-map-item">MongoDB知识体系</a></li><li><a href="/doc-backend/database/springBootMongodb.html" class="sidebar-link siderbar-map-item">Spring-boot对Mongo的操作</a></li><li><a href="/doc-backend/database/windowsmongoaq.html" class="sidebar-link siderbar-map-item">windows版mongo启动安全认证</a></li></ul></div></li><li><div class="sidebar-group"><ul class="sidebar-group-items"><li><a href="/doc-backend/database/PostgreSQL.html" aria-current="page" class="active sidebar-link siderbar-map-item">PostgreSQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#一、postgresql-特点" class="sidebar-link siderbar-map-item">一、PostgreSQL 特点</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#二、下载与安装" class="sidebar-link siderbar-map-item">二、下载与安装</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#三、系统对象" class="sidebar-link siderbar-map-item">三、系统对象</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#四、权限管理" class="sidebar-link siderbar-map-item">四、权限管理</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#五、表操作" class="sidebar-link siderbar-map-item">五、表操作</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#控制台命令" class="sidebar-link siderbar-map-item">控制台命令</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#六、特性" class="sidebar-link siderbar-map-item">六、特性</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#八、数据库迁移" class="sidebar-link siderbar-map-item">八、数据库迁移</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#九、postgis" class="sidebar-link siderbar-map-item">九、postGIS</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#十、pg-简单用法" class="sidebar-link siderbar-map-item">十、pg 简单用法</a></li></ul></li></ul></div></li></ul> </div></div> <div class="sidebar"><div class="c-sidebar"> <div class="search-box"><input aria-label="Search" placeholder="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Mango</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc-backend/database/Mongoazyx.html" class="sidebar-link">Mongo安装运行</a></li><li><a href="/doc-backend/database/Mongoccwj.html" class="sidebar-link">Mongo存储文件—GridFS</a></li><li><a href="/doc-backend/database/MongoDBjc.html" class="sidebar-link">MongoDB基础</a></li><li><a href="/doc-backend/database/MongoDBsy.html" class="sidebar-link">MongoDB权限操作</a></li><li><a href="/doc-backend/database/MongoDBzstx.html" class="sidebar-link">MongoDB知识体系</a></li><li><a href="/doc-backend/database/springBootMongodb.html" class="sidebar-link">Spring-boot对Mongo的操作</a></li><li><a href="/doc-backend/database/windowsmongoaq.html" class="sidebar-link">windows版mongo启动安全认证</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>PostgreSQL</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc-backend/database/PostgreSQL.html" aria-current="page" class="active sidebar-link">PostgreSQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#一、postgresql-特点" class="sidebar-link">一、PostgreSQL 特点</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#二、下载与安装" class="sidebar-link">二、下载与安装</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#三、系统对象" class="sidebar-link">三、系统对象</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#四、权限管理" class="sidebar-link">四、权限管理</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#五、表操作" class="sidebar-link">五、表操作</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#控制台命令" class="sidebar-link">控制台命令</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#六、特性" class="sidebar-link">六、特性</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#八、数据库迁移" class="sidebar-link">八、数据库迁移</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#九、postgis" class="sidebar-link">九、postGIS</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/PostgreSQL.html#十、pg-简单用法" class="sidebar-link">十、pg 简单用法</a></li></ul></li></ul></div></li></ul> </div></div> <!----> <!----> <div class="page"><div class="content-pagex content content__default"><h1 id="postgresql"><a href="#postgresql" class="header-anchor">#</a> PostgreSQL</h1> <p>[TOC]</p> <h2 id="一、postgresql-特点"><a href="#一、postgresql-特点" class="header-anchor">#</a> 一、PostgreSQL 特点</h2> <p>PostgreSQL 的特点如下 -</p> <ul><li>PostgreSQL 可在所有主要操作系统(即 Linux，UNIX(AIX，BSD，HP-UX，SGI IRIX，Mac OS X，Solaris，Tru64)和 Windows 等)上运行。</li> <li>PostgreSQL 支持文本，图像，声音和视频，并包括用于 C/C++，Java，Perl，Python，Ruby，Tcl 和开放数据库连接(ODBC)的编程接口。</li> <li>PostgreSQL 支持 SQL 的许多功能，例如复杂 SQL 查询，SQL 子选择，外键，触发器，视图，事务，多进程并发控制(MVCC)，流式复制(9.0)，热备(9.0))。</li> <li>在 PostgreSQL 中，表可以设置为从“父”表继承其特征。</li> <li>可以安装多个扩展以向 PostgreSQL 添加附加功能。</li></ul> <p>PostgreSQL 工具</p> <ol><li><p>psql：它是一个命令行工具，也是管理 PostgreSQL 的主要工具。 <code>pgAdmin</code>是 PostgreSQL 的免费开源图形用户界面管理工具。</p></li> <li><p>phpPgAdmin</p> <p>它是用 PHP 编写的 PostgreSQL 的基于 Web 的管理工具。 它基于 phpMyAdmin 工具管理 MySQL 功能来开发。它可以用作 PostgreSQL 的前端工具。</p></li> <li><p>pgFouine</p> <p>它是一个日志分析器，可以从 PostgreSQL 日志文件创建报告。 专有工具有 -
Lightning Admin for PostgreSQL, Borland Kylix, DBOne, DBTools Manager PgManager, Rekall, Data Architect, SyBase Power Designer, Microsoft Access, eRWin, DeZign for Databases, PGExplorer, Case Studio 2, pgEdit, RazorSQL, MicroOLAP Database Designer, Aqua Data Studio, Tuples, EMS Database Management Tools for PostgreSQL, Navicat, SQL Maestro Group products for PostgreSQL, Datanamic DataDiff for PostgreSQL, Datanamic SchemaDiff for PostgreSQL, DB MultiRun PostgreSQL Edition, SQLPro, SQL Image Viewer, SQL Data Sets 等等.</p></li> <li><p>Navicat for PostSQL</p></li></ol> <p>感觉更好用，但是收费</p> <h2 id="二、下载与安装"><a href="#二、下载与安装" class="header-anchor">#</a> 二、下载与安装</h2> <p><a href="%5Bhttps://www.enterprisedb.com/software-downloads-postgres%5D(https://www.enterprisedb.com/software-downloads-postgres)">PostgreSQL 下载</a></p> <h3 id="修改启动的服务名"><a href="#修改启动的服务名" class="header-anchor">#</a> 修改启动的服务名</h3> <p>默认是自动启动的，可以改为手动，默认启动命令是 net start postgresql-64-10 太长了，想改改, 如下</p> <ol><li>win+r 输入 regedit</li> <li>依次打开 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\CurrentControlSet\Services\postgresql-64-10 （这里是你的版本名称） 把这个文件重命名一下（我这里改成了 postgresql）</li> <li>重启之后， 在命令行输入 net start postgresql 就可以启动服务了 net stop postgresql 关闭服务</li></ol> <h3 id="修改配置文件"><a href="#修改配置文件" class="header-anchor">#</a> 修改配置文件</h3> <ol><li>修改 postgresql 中的 listen_addresses = ‘*’ //表示允许所有机器访问</li> <li>在 pg_hba.conf 文件最下面添加允许访问的 IP 等</li> <li>如果远程连接不上，1. 可以关闭防火墙。
或者 2.控制面板-&gt;windows...防火墙-&gt;高级设置，然后点击左侧&quot;入站规则&quot;，点击右侧&quot;新建规则&quot;, 依次是 ： 端口， TCP ，在特定本地端口输入 5432，然后下一步下一步 点完就行了。
当然其中有些东西是你自己看着选择的。</li></ol> <p>关于第 2 点配置 ip</p> <table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">host</th> <th style="text-align:center;">DATABASE</th> <th style="text-align:center;">USER</th> <th style="text-align:center;">ADDRESS</th> <th style="text-align:center;">METHOD</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">数据库</td> <td style="text-align:center;">用户</td> <td style="text-align:center;">ip</td> <td style="text-align:center;">加密方式</td></tr> <tr><td style="text-align:center;">全部可连:</td> <td style="text-align:center;">host</td> <td style="text-align:center;">all</td> <td style="text-align:center;">all</td> <td style="text-align:center;">all</td> <td style="text-align:center;">md5</td></tr> <tr><td style="text-align:center;">192.168 网段下可连:</td> <td style="text-align:center;">host</td> <td style="text-align:center;">all</td> <td style="text-align:center;">all</td> <td style="text-align:center;">192.168.1.0/24</td> <td style="text-align:center;">md5</td></tr> <tr><td style="text-align:center;">192.168.1.80 可连</td> <td style="text-align:center;">host</td> <td style="text-align:center;">all</td> <td style="text-align:center;">all</td> <td style="text-align:center;">192.168.1.80/32</td> <td style="text-align:center;">md5</td></tr></tbody></table> <p>配置 ip 需要注意的地方</p> <p>以上内容需要注意以下两点：</p> <ol><li>数据库名与用户名注意大小写，PostgreSQL 是区分大小的；
　　　 2. CIDR-ADDRESS（用户的 IP 范围）的值的格式是：IP/数值
数值取值范围为：0,8,16,24,32 　即表示掩码 bit 的个数；
　　　　 例如：
　　　　　 32 -&gt; 192.168.1.1/32 表示必须是来自这个 IP 地址的访问才合法；
　　　　　 24 -&gt; 192.168.1.0/24 表示只要来自 192.168.1.0 ~ 192.168.1.255 的都合法；
　　　　　 16 -&gt; 192.168.0.0/16 表示只要来自 192.168.0.0 ~ 192.168.255.255 的都合法；
　　　　　 8   -&gt; 192.0.0.0/16 表示只要来自 192.0.0.0 ~ 192.255.255.255 的都合法；
　　　　　 0   -&gt; 0.0.0.0/0 表示全部 IP 地址都合法，/左边的 IP 地址随便了只要是合法的 IP 地址即可；</li></ol> <h2 id="三、系统对象"><a href="#三、系统对象" class="header-anchor">#</a> 三、系统对象</h2> <h3 id="用户-角色"><a href="#用户-角色" class="header-anchor">#</a> 用户/角色</h3> <p>创建用户语法: CREATE USER name [ [ WITH ] option [ ... ] ]</p> <p>option 可以是 以下部分，注意，这不是全部，查看全部可以在 SQL Shell(psql)中使用 \h create user 命令</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>SUPERUSER<span class="token operator">|</span> NOSUPERUSER <span class="token comment">--超级用户</span>
<span class="token operator">|</span> CREATEDB<span class="token operator">|</span> NOCREATEDB	<span class="token comment">--创建库</span>
<span class="token operator">|</span> CREATEROLE <span class="token operator">|</span> NOCREATEROLE	<span class="token comment">--创建角色(用户)</span>
<span class="token operator">|</span> INHERIT <span class="token operator">|</span> NOINHERIT  <span class="token comment">--继承</span>
<span class="token operator">|</span> LOGIN <span class="token operator">|</span> NOLOGIN 	<span class="token comment">--登陆权限</span>
<span class="token operator">|</span> CONNECTION <span class="token keyword">LIMIT</span> connlimit  <span class="token comment">--设置链接次数</span>
<span class="token operator">|</span> <span class="token punctuation">[</span> ENCRYPTED <span class="token punctuation">]</span> PASSWORD <span class="token string">'password'</span>  <span class="token comment">-- 设置密码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>创建用户</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 创建普通用户并设置密码</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">&quot;test&quot;</span> PASSWORD <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token comment">-- 创建超级用户</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">&quot;test&quot;</span> PASSWORD <span class="token string">'123456'</span> SUPERUSER<span class="token punctuation">;</span>
<span class="token comment">--创建用户并授权</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">&quot;test&quot;</span> PASSWORD <span class="token string">'123456'</span> CREATEDB CREATEROLE<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>修改用户</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--看命令去吧 \h alter user</span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> role_specification <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">]</span> 选项 <span class="token punctuation">[</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
eg<span class="token punctuation">.</span> <span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">WITH</span> SUPERUSER
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>删除用户</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>\h <span class="token keyword">drop</span> <span class="token keyword">user</span>
<span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token punctuation">[</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">]</span> 名称 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
eg<span class="token punctuation">.</span> <span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>查看</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">=</span><span class="token comment"># select * from pg_user;  --查看所有用户</span>
postgres<span class="token operator">=</span><span class="token comment"># select * from pg_roles;  --查看所有角色</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="表空间"><a href="#表空间" class="header-anchor">#</a> 表空间</h3> <p>postgersql 中表空间实际上就是给表指定一个存储目录</p> <ol><li>创建</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">-</span><span class="token comment"># \h create tablespace</span>
命令：       <span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span>
描述：       建立新的表空间
语法：
<span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> 表空间的名称
    <span class="token punctuation">[</span> OWNER { 新的属主 <span class="token operator">|</span> <span class="token keyword">CURRENT_USER</span> <span class="token operator">|</span> <span class="token keyword">SESSION_USER</span> } <span class="token punctuation">]</span>
    LOCATION <span class="token string">'目录'</span>
    <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">(</span> 表空间_选项 <span class="token operator">=</span> 值 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">]</span>

eg<span class="token punctuation">.</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> <span class="token string">&quot;test_tbspace&quot;</span> OWNER <span class="token string">&quot;test&quot;</span> LOCATION <span class="token string">'e:\tbspaces'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="2"><li>修改</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>命令：       <span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span>
描述：       更改表空间的定义
语法：
<span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> 名称 <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> 新的名称
<span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> 名称 OWNER <span class="token keyword">TO</span> { 新的属主 <span class="token operator">|</span> <span class="token keyword">CURRENT_USER</span> <span class="token operator">|</span> <span class="token keyword">SESSION_USER</span> }
<span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> 名称 <span class="token keyword">SET</span> <span class="token punctuation">(</span> 表空间_选项 <span class="token operator">=</span> 值 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> 名称 RESET <span class="token punctuation">(</span> 表空间_选项 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>查看</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 列出所有表空间</span>
postgres<span class="token operator">=</span><span class="token comment"># \db</span>
表空间列表
名称     <span class="token operator">|</span>  拥有者  <span class="token operator">|</span> 所在地
<span class="token comment">--------------+----------+---------</span>
pg_default   <span class="token operator">|</span> postgres <span class="token operator">|</span>
pg_global    <span class="token operator">|</span> postgres <span class="token operator">|</span>
test_tbspace <span class="token operator">|</span> test     <span class="token operator">|</span> E:\tbspaces

<span class="token comment">-- 查看表空间下的表信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_tables <span class="token keyword">where</span> <span class="token keyword">tablespace</span> <span class="token operator">=</span> <span class="token string">'test_tbspace'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="4"><li>系统自带表空间</li></ol> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">表空间pg_default是用来存储系统目录对象、用户表、用户表index、和临时表、临时表index、内部临时表的默认空间。对应存储目录%</span><span class="token punctuation">{</span>PostgreSQL<span class="token punctuation">}</span><span class="token selector">%data/base/
表空间pg_global用来存放系统字典表；对应存储目录%</span><span class="token punctuation">{</span>PostgreSQL<span class="token punctuation">}</span>%/data/global/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="5"><li>将表从一个表空间移到另一个表空间</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> name <span class="token keyword">SET</span> <span class="token keyword">TABLESPACE</span> new_tablespace
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="6"><li><p>删除</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>DROP TABLESPACE [ IF EXISTS ] 名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <p><a href="%5Bhttps://www.cnblogs.com/lottu/p/9239535.html%5D(https://www.cnblogs.com/lottu/p/9239535.html)">参考地址</a></p> <h3 id="数据库"><a href="#数据库" class="header-anchor">#</a> 数据库</h3> <p>创建</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">-</span><span class="token comment"># \h create database</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> 名称
    <span class="token punctuation">[</span> <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> OWNER <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 用户名 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> TEMPLATE <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 模版 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> ENCODING <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 字符集编码 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> LC_COLLATE <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 排序规则 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> LC_CTYPE <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 字符分类 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> <span class="token keyword">TABLESPACE</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 表空间的名称 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> ALLOW_CONNECTIONS <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> allowconn <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> CONNECTION <span class="token keyword">LIMIT</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> 连接限制 <span class="token punctuation">]</span>
           <span class="token punctuation">[</span> IS_TEMPLATE <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> istemplate <span class="token punctuation">]</span> <span class="token punctuation">]</span>

eg<span class="token punctuation">.</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> testdb OWNER <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span> ENCODING <span class="token operator">=</span> <span class="token string">&quot;UTF-8&quot;</span> <span class="token keyword">TABLESPACE</span> <span class="token operator">=</span> <span class="token string">&quot;test_tbspace&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>修改数据库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">-</span><span class="token comment"># \h alter database</span>
命令：       <span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span>
描述：       更改一个数据库
语法：
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 <span class="token punctuation">[</span> <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">]</span> 选项 <span class="token punctuation">[</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span>

选项可以是

    ALLOW_CONNECTIONS allowconn
    CONNECTION <span class="token keyword">LIMIT</span> 连接限制
    IS_TEMPLATE istemplate

<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> 新的名称  <span class="token comment">-- 修改数据库的名</span>

<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 OWNER <span class="token keyword">TO</span> { 新的属主 <span class="token operator">|</span> <span class="token keyword">CURRENT_USER</span> <span class="token operator">|</span> <span class="token keyword">SESSION_USER</span> }

<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 <span class="token keyword">SET</span> <span class="token keyword">TABLESPACE</span> 新的表空间	<span class="token comment">--修改数据库的表空间</span>

<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 <span class="token keyword">SET</span> 配置参数 { <span class="token keyword">TO</span> <span class="token operator">|</span> <span class="token operator">=</span> } { 值 <span class="token operator">|</span> <span class="token keyword">DEFAULT</span> }
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 <span class="token keyword">SET</span> 配置参数 <span class="token keyword">FROM</span> <span class="token keyword">CURRENT</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 RESET 配置参数
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> 名称 RESET <span class="token keyword">ALL</span>	<span class="token comment">-- 重置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>删除数据库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">]</span> 名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​</p> <h3 id="模式"><a href="#模式" class="header-anchor">#</a> 模式</h3> <p>创建</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">-</span><span class="token operator">&gt;</span> \h <span class="token keyword">create</span> <span class="token keyword">schema</span>
命令：       <span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span>
描述：       建立新的架构模式
语法：
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> 模式名称 <span class="token punctuation">[</span> <span class="token keyword">AUTHORIZATION</span> role_specification <span class="token punctuation">]</span> <span class="token punctuation">[</span> 模式中对象 <span class="token punctuation">[</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">AUTHORIZATION</span> role_specification <span class="token punctuation">[</span> 模式中对象 <span class="token punctuation">[</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> 模式名称 <span class="token punctuation">[</span> <span class="token keyword">AUTHORIZATION</span> role_specification <span class="token punctuation">]</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token keyword">AUTHORIZATION</span> role_specification

这里role_specification可以是：

    用户名
  <span class="token operator">|</span> <span class="token keyword">CURRENT_USER</span>
  <span class="token operator">|</span> <span class="token keyword">SESSION_USER</span>

<span class="token comment">--创建一个模式，设置所属用户为test</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">AUTHORIZATION</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>查看</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 使用 \dn也可以 只有名称和拥有着两列</span>
postgres<span class="token operator">-</span><span class="token operator">&gt;</span> \dn<span class="token operator">+</span>
                            架构模式列表
   名称   <span class="token operator">|</span>  拥有者  <span class="token operator">|</span>       存取权限       <span class="token operator">|</span>          描述
<span class="token comment">----------+----------+----------------------+------------------------</span>
 myschema <span class="token operator">|</span> postgres <span class="token operator">|</span>                      <span class="token operator">|</span>
 <span class="token keyword">public</span>   <span class="token operator">|</span> postgres <span class="token operator">|</span> postgres<span class="token operator">=</span>UC<span class="token operator">/</span>postgres<span class="token operator">+</span><span class="token operator">|</span> standard <span class="token keyword">public</span> <span class="token keyword">schema</span>
          <span class="token operator">|</span>          <span class="token operator">|</span> <span class="token operator">=</span>UC<span class="token operator">/</span>postgres         <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>删除</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">=</span><span class="token operator">&gt;</span> \h <span class="token keyword">drop</span> <span class="token keyword">schema</span>
命令：       <span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span>
描述：       移除一个模式
语法：
<span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span> <span class="token punctuation">[</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">]</span> 名称 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token keyword">CASCADE</span> <span class="token operator">|</span> <span class="token keyword">RESTRICT</span> <span class="token punctuation">]</span>

<span class="token comment">--删除一个模式</span>
<span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test_schema&quot;</span><span class="token punctuation">;</span>
<span class="token comment">--如果schema中存在对象,则需要使用cascade选项:</span>
<span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test_schema&quot;</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="四、权限管理"><a href="#四、权限管理" class="header-anchor">#</a> 四、权限管理</h2> <p>postgresql 中的权限可以大概分为以下几种</p> <table><thead><tr><th>权限</th> <th>说明</th></tr></thead> <tbody><tr><td>SELECT</td> <td><strong>该权限用来查询表或是表上的某些列，或是视图，序列。</strong></td></tr> <tr><td>INSERT</td> <td><strong>该权限允许对表或是视图进行插入数据操作，也可以使用 COPY FROM 进行数据的插入</strong></td></tr> <tr><td>UPDATE</td> <td><strong>该权限允许对表或是或是表上特定的列或是视图进行更新操作</strong></td></tr> <tr><td>DELETE</td> <td><strong>该权限允许对表或是视图进行删除数据的操作</strong></td></tr> <tr><td>TRUNCATE</td> <td><strong>允许对表进行清空操作</strong></td></tr> <tr><td>REFERENCES</td> <td><strong>允许给参照列和被参照列上创建外键约束</strong></td></tr> <tr><td>TRIGGER</td> <td><strong>允许在表上创建触发器</strong></td></tr> <tr><td>CREATE</td> <td><strong>对于数据库，允许在数据库上创建 Schema；对于 Schema，允许对 Schema 上创建数据库对象；对于表空间，允许把表或是索引指定到对应的表空间上</strong></td></tr> <tr><td>CONNECT</td> <td><strong>允许用户连接到指定的数据库上</strong></td></tr> <tr><td>TEMPORARY 或是 TEMP</td> <td><strong>允许在指定数据库的时候创建临时表</strong></td></tr> <tr><td>EXECUTE</td> <td>允许执行某个函数</td></tr> <tr><td>USAGE</td> <td>对于程序语言来说，允许使用指定的程序语言创建函数；对于 Schema 来说，允许查找该 Schema 下的对象；对于序列来说，允许使用 currval 和 nextval 函数；对于外部封装器来说，允许使用外部封装器来创建外部服务器；对于外部服务器来说，允许创建外部表。</td></tr> <tr><td>ALL PRIVILEGES</td> <td>表示一次性给予可以授予的权限</td></tr></tbody></table> <h3 id="schema-权限管理"><a href="#schema-权限管理" class="header-anchor">#</a> schema 权限管理</h3> <p>如果用户要访问某张表，那么首先需要有访问该表所在 schema 的权限，默认只有 schema 的拥有者可以直接操作该 schema，其他用户需要授权（public 这个 schema 除外）</p> <p><strong>在 SQL Shell(psql)中使用 \h grant 查看更多命令</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--将schema的权限赋予给了指定用户</span>
<span class="token keyword">grant</span> <span class="token keyword">create</span> <span class="token keyword">on</span> <span class="token keyword">schema</span> <span class="token string">&quot;test_schema&quot;</span> <span class="token keyword">to</span> <span class="token string">&quot;test&quot;</span>

<span class="token comment">--将schema中usage权限赋予给brent用户</span>
<span class="token keyword">grant</span> <span class="token keyword">usage</span> <span class="token keyword">on</span> <span class="token keyword">schema</span> <span class="token string">&quot;test_schema&quot;</span> <span class="token keyword">to</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

<span class="token comment">--将schema中all权限赋予给test用户,all表示一次性给予可以授予的所有权限</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token keyword">schema</span> <span class="token string">&quot;test_schema&quot;</span> <span class="token keyword">to</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

<span class="token comment">--查看所有的schema</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">;</span>

<span class="token comment">-- 查看某个用户的所有schema</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata <span class="token keyword">where</span> schema_owner <span class="token operator">=</span> <span class="token string">'用户名'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="表权限管理"><a href="#表权限管理" class="header-anchor">#</a> 表权限管理</h3> <p>默认的，如果没有特别的授权，普通用户只能访问所有者为自己的表，超级用户可以访问任意表。如果访问非自己的表，那么就需要对表进行授权，当我们以”test“用户想访问 ”other_schema&quot;模式下所属用户为&quot;qiao&quot;的 student 表的时候就会报错。</p> <p>将表的查询和插入权限赋予用户</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 赋权之后就可以访问了</span>
<span class="token keyword">grant</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span> <span class="token keyword">on</span> other_schema<span class="token punctuation">.</span>student <span class="token keyword">to</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>
<span class="token comment">-- 收回权限 revoke</span>
<span class="token keyword">revoke</span> <span class="token keyword">select</span> <span class="token keyword">on</span> other_schema<span class="token punctuation">.</span>studen <span class="token keyword">from</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="角色管理"><a href="#角色管理" class="header-anchor">#</a> 角色管理</h3> <p>我们除了可以将表的权限赋予给用户,我们还可以将角色赋予给用户,那么用户就会拥有赋予角色的相关权限:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 给用户test授予role1这个角色</span>
<span class="token keyword">grant</span> role1 <span class="token keyword">to</span> test<span class="token punctuation">;</span>
<span class="token comment">-- 收回test用户的role1角色</span>
<span class="token keyword">revoke</span> role1 <span class="token keyword">from</span> test<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>查询表权限角色列表</p> <p>使用\dp 或者\z 命令</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">=</span><span class="token comment"># \dp person;</span>

详细的权限说明如下:
            r <span class="token comment">-- SELECT (&quot;读&quot;)</span>
            w <span class="token comment">-- UPDATE (&quot;写&quot;)</span>
            a <span class="token comment">-- INSERT (&quot;追加&quot;)</span>
            d <span class="token comment">-- DELETE</span>
            D <span class="token comment">-- TRUNCATE</span>
            x <span class="token comment">-- REFERENCES</span>
            t <span class="token comment">-- TRIGGER</span>
            X <span class="token comment">-- EXECUTE</span>
            U <span class="token comment">-- USAGE</span>
            C <span class="token comment">-- CREATE</span>
            c <span class="token comment">-- CONNECT</span>
            T <span class="token comment">-- TEMPORARY</span>
      arwdDxt <span class="token comment">-- ALL PRIVILEGES (对于表，对其他对象会变化)</span>
            <span class="token operator">*</span> <span class="token comment">-- 用于前述特权的授权选项</span>
        <span class="token operator">/</span>yyyy <span class="token comment">-- 授予该特权的角色</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>使用\du 查看用户与角色之间的关系</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查看用户用户test的权限与角色</span>
postgres<span class="token operator">=</span><span class="token comment"># \du test</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看 test 用户具备的具体权限</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>role_table_grants <span class="token keyword">where</span> grantee<span class="token operator">=</span><span class="token string">'test'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参考：<a href="https://blog.csdn.net/su377486/article/details/80672867" target="_blank" rel="noopener noreferrer">原文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>###Search_path</p> <ol><li><p>PostgreSQL 中有一个环境变量 search_path，它是一个模式列表。<strong>search_path 路径中的第一个模式被称为 current schema</strong>， <strong>这里推荐模式名与用户名相同</strong>。</p> <p>查询 Search_path 环境变量</p></li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>postgres<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">show</span> search_path<span class="token punctuation">;</span>
   search_path
<span class="token comment">-----------------</span>
 <span class="token string">&quot;$user&quot;</span><span class="token punctuation">,</span> <span class="token keyword">public</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li><p>从查询结果看，PostgreSQL 会首先在与当前用户名相同的模式中查询，如果相关数据不在此模式中，则会继续其余的模式中查询（如上面的 public）,以此类推。</p> <p>如果在 search_path 下的模式种都没有匹配到目标对象，则会出错。</p></li> <li><p>如果创建了一个模式 myschema，查询模式下的表时出错了，查询 search_path 后没有看到创建的模式，那么</p> <p>添加模式至 Search_path 环境变量</p></li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> search_path <span class="token operator">=</span> <span class="token string">&quot;$user&quot;</span><span class="token punctuation">,</span> <span class="token keyword">public</span><span class="token punctuation">,</span> myschema<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>设置数据库的默认模式（即，该数据库只使用某个模式下的数据）</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">database</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">SET</span> search_path <span class="token keyword">TO</span> test<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="五、表操作"><a href="#五、表操作" class="header-anchor">#</a> 五、表操作</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* 增加让主键自增的权限 */</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> sequence tablename_keyname_seq <span class="token keyword">to</span> webuser<span class="token punctuation">;</span>

 <span class="token comment">/* 重命名一个表 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名A<span class="token punctuation">]</span> <span class="token keyword">rename</span> <span class="token keyword">to</span> <span class="token punctuation">[</span>表名B<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 删除一个表 */</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 在已有的表里添加字段 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">add</span> <span class="token keyword">column</span> <span class="token punctuation">[</span>字段名<span class="token punctuation">]</span> <span class="token punctuation">[</span>类型<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 删除表中的字段 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">drop</span> <span class="token keyword">column</span> <span class="token punctuation">[</span>字段名<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 重命名一个字段 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">rename</span> <span class="token keyword">column</span> <span class="token punctuation">[</span>字段名A<span class="token punctuation">]</span> <span class="token keyword">to</span> <span class="token punctuation">[</span>字段名B<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 给一个字段设置缺省值 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">alter</span> <span class="token keyword">column</span> <span class="token punctuation">[</span>字段名<span class="token punctuation">]</span> <span class="token keyword">set</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>新的默认值<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 去除缺省值 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">alter</span> <span class="token keyword">column</span> <span class="token punctuation">[</span>字段名<span class="token punctuation">]</span> <span class="token keyword">drop</span> <span class="token keyword">default</span><span class="token punctuation">;</span>

<span class="token comment">/* 插入数据 */</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> 表名 <span class="token punctuation">(</span><span class="token punctuation">[</span>字段名m<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>字段名n<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>列m的值<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>列n的值<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 修改数据 */</span>
<span class="token keyword">update</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">set</span> <span class="token punctuation">[</span>目标字段名<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span>目标值<span class="token punctuation">]</span> <span class="token keyword">where</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>

<span class="token comment">/* 删除数据 */</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">where</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>

<span class="token comment">/* 删除表 */</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 查询 */</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dbname <span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>

<span class="token comment">/* 创建表 */</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token punctuation">(</span>
    <span class="token punctuation">[</span>字段名<span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>类型<span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>字段名<span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>类型<span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>字段名n<span class="token punctuation">]</span> <span class="token punctuation">[</span>字段名n<span class="token punctuation">]</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>参考：<a href="https://blog.csdn.net/qq_24879495/article/details/78039712" target="_blank" rel="noopener noreferrer">原文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>##常用语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">------------------------- 注意：------------------------</span>
<span class="token comment">-- 1、postgresql中大小写不敏感 重命名时请使用双引号</span>
<span class="token keyword">select</span> <span class="token string">'qiao'</span> <span class="token keyword">as</span> <span class="token string">&quot;firstName&quot;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2、没有 dual 下面创建一个dual视图</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> dual <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">--------------------------数据库------------------------------</span>
<span class="token comment">-- 查看当前数据库的版本</span>
<span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看所有数据库</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_database
<span class="token comment">--查看用户的数据库</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_database <span class="token keyword">where</span> datname <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">----------------------------------连接------------------------</span>
<span class="token comment">--查看最大连接数</span>
<span class="token keyword">show</span> max_connections<span class="token punctuation">;</span> <span class="token comment">-- 可以在postgresql.conf中修改</span>
<span class="token comment">-- 查看当前连接用户</span>
  <span class="token keyword">SELECT</span>
      A<span class="token punctuation">.</span>pid<span class="token punctuation">,</span>
      A<span class="token punctuation">.</span>usename 用户名<span class="token punctuation">,</span>
      A<span class="token punctuation">.</span>application_name 连接工具<span class="token punctuation">,</span>
      A<span class="token punctuation">.</span>client_addr 连接地址
  <span class="token keyword">FROM</span>
      pg_stat_activity A
  <span class="token keyword">WHERE</span>
      <span class="token operator">NOT</span> pid <span class="token operator">=</span> pg_backend_pid <span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> usesysid <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- 关闭连接</span>
<span class="token keyword">SELECT</span> pg_terminate_backend<span class="token punctuation">(</span>pid<span class="token punctuation">)</span>

<span class="token comment">------------------------------用户-------------------------</span>
<span class="token comment">-- 查看当前链接用户</span>
<span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token comment">--查看所有用户</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_user<span class="token punctuation">;</span>
<span class="token comment">-- 查看所有角色</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_roles


<span class="token comment">-- 根据用户名查看用户的表空间</span>
<span class="token keyword">SELECT</span> A <span class="token punctuation">.</span>spcname<span class="token punctuation">,</span>B<span class="token punctuation">.</span>usename <span class="token keyword">FROM</span> pg_tablespace A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> pg_user B <span class="token keyword">ON</span> A <span class="token punctuation">.</span>spcowner <span class="token operator">=</span> B<span class="token punctuation">.</span>usesysid <span class="token keyword">WHERE</span> usename <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">USER</span><span class="token punctuation">)</span> <span class="token comment">-- 这里填写用户名</span>

<span class="token comment">-- 查看用户具备的具体权限</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>role_table_grants <span class="token keyword">where</span> grantee<span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看用户的 表、索引、序列、视图(“关系”)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_class <span class="token keyword">where</span> relowner <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> usesysid <span class="token keyword">from</span> pg_user <span class="token keyword">where</span> usename <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">USER</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 查看用户的视图</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_views <span class="token keyword">where</span> viewowner <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">---------------------------角色---------------------------</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_roles<span class="token punctuation">;</span> 	<span class="token comment">-- 查看所有角色</span>



<span class="token comment">------------------------------------表空间-------------------------</span>
<span class="token comment">-- 查看所有表空间</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_tablespace <span class="token punctuation">;</span>

<span class="token comment">-- 查看用户下的表空间</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_tablespace <span class="token keyword">where</span> spcowner <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> usesysid <span class="token keyword">from</span> pg_user <span class="token keyword">WHERE</span> usename <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 查看表空间下的表</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> pg_tables <span class="token keyword">where</span> <span class="token keyword">tablespace</span> <span class="token operator">=</span> <span class="token string">'表空间名'</span><span class="token punctuation">;</span>


<span class="token comment">--------------------------------模式------------------------</span>
<span class="token comment">--------查看所有的schema----------------</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">;</span>
<span class="token comment">--查看模式(schame)下的表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema <span class="token operator">=</span> <span class="token string">'模式名'</span>
<span class="token comment">-- 查看某个用户的所有schema</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata <span class="token keyword">where</span> schema_owner <span class="token operator">=</span> <span class="token string">'用户名'</span><span class="token punctuation">;</span>


<span class="token comment">------------------------------权限------------------------------</span>
<span class="token comment">-- 查看用户具备的具体权限</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>role_table_grants <span class="token keyword">where</span> grantee<span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">;</span>

<span class="token comment">--查看usage权限表</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>usage_privileges <span class="token keyword">where</span> grantee<span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">;</span>

<span class="token comment">--查看存储过程函数相关权限表</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>routine_privileges <span class="token keyword">where</span> grantee<span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">;</span>


<span class="token comment">----------------查看表结构-------------</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>attnum<span class="token punctuation">,</span>
a<span class="token punctuation">.</span>attname <span class="token keyword">AS</span> field<span class="token punctuation">,</span>
t<span class="token punctuation">.</span>typname <span class="token keyword">AS</span> <span class="token keyword">type</span><span class="token punctuation">,</span>
a<span class="token punctuation">.</span>attlen <span class="token keyword">AS</span> length<span class="token punctuation">,</span>
a<span class="token punctuation">.</span>atttypmod <span class="token keyword">AS</span> lengthvar<span class="token punctuation">,</span>
a<span class="token punctuation">.</span>attnotnull <span class="token keyword">AS</span> notnull<span class="token punctuation">,</span>
b<span class="token punctuation">.</span>description <span class="token keyword">AS</span> <span class="token keyword">comment</span>
<span class="token keyword">FROM</span> pg_class c<span class="token punctuation">,</span>
pg_attribute a
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> pg_description b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>attrelid<span class="token operator">=</span>b<span class="token punctuation">.</span>objoid <span class="token operator">AND</span> a<span class="token punctuation">.</span>attnum <span class="token operator">=</span> b<span class="token punctuation">.</span>objsubid<span class="token punctuation">,</span>
pg_type t
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>relname <span class="token operator">=</span> <span class="token string">'表名'</span>
<span class="token operator">and</span> a<span class="token punctuation">.</span>attnum <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token operator">and</span> a<span class="token punctuation">.</span>attrelid <span class="token operator">=</span> c<span class="token punctuation">.</span>oid
<span class="token operator">and</span> a<span class="token punctuation">.</span>atttypid <span class="token operator">=</span> t<span class="token punctuation">.</span>oid
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>attnum<span class="token punctuation">;</span>
<span class="token comment">-------------查看模式下的所有函数-------------------------------</span>
<span class="token keyword">SELECT</span>
	routines<span class="token punctuation">.</span>ROUTINE_NAME<span class="token punctuation">,</span>
	PARAMETERS<span class="token punctuation">.</span>data_type<span class="token punctuation">,</span>
	PARAMETERS<span class="token punctuation">.</span>ordinal_position
<span class="token keyword">FROM</span>
	information_schema<span class="token punctuation">.</span>routines
<span class="token keyword">JOIN</span> information_schema<span class="token punctuation">.</span>PARAMETERS <span class="token keyword">ON</span> routines<span class="token punctuation">.</span>SPECIFIC_NAME <span class="token operator">=</span> PARAMETERS<span class="token punctuation">.</span>SPECIFIC_NAME
<span class="token keyword">WHERE</span>
	routines<span class="token punctuation">.</span>specific_schema <span class="token operator">=</span> <span class="token string">'模式名'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	routines<span class="token punctuation">.</span>ROUTINE_NAME<span class="token punctuation">,</span>
	PARAMETERS<span class="token punctuation">.</span>ordinal_position<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br></div></div><p>参考：<a href="%5Bhttps://blog.csdn.net/pg_hgdb/article/details/80180467%5D(https://blog.csdn.net/pg_hgdb/article/details/80180467)">Postgresql 之 系统表概述</a></p> <h2 id="控制台命令"><a href="#控制台命令" class="header-anchor">#</a> 控制台命令</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>\h   <span class="token comment">--帮助命令</span>
\l  <span class="token comment">-- 列出所有数据库</span>
\c <span class="token punctuation">[</span>database_name<span class="token punctuation">]</span> <span class="token comment">--连接其他数据库</span>
\c <span class="token operator">-</span> username  <span class="token comment">--切换用户</span>
\c dbname username  <span class="token comment">--使用username用户链接dbname数据库</span>
\du 	<span class="token comment">--查看所有用户与角色的关系   角色名称 |  属性 | 成员属于</span>
\dn <span class="token punctuation">(</span>dn<span class="token operator">+</span><span class="token punctuation">)</span> 		<span class="token comment">--查看数据库的schema</span>
<span class="token comment">--\d 数据库 		--查看模式中表的名字 （select * from pg_tables where schemaname = 'public'）</span>
\d  <span class="token punctuation">[</span>table_name<span class="token punctuation">]</span> 	<span class="token comment">--查看表结构</span>
\dt  <span class="token comment">--查看当前数据库下的所有表</span>
\dv pg_<span class="token operator">*</span> <span class="token comment">--查看以pg_开头的视图</span>
\dp<span class="token punctuation">(</span>\z<span class="token punctuation">)</span>	<span class="token comment">--查询表上已经分配的权限列表</span>
\e	<span class="token comment">--打开文本编辑器</span>
\conninfo	<span class="token comment">--列出当前数据库和连接的信息。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>扩展控制台命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>\copyright            显示PostgreSQL的使用和发行许可条款
  \g [文件] or;             执行查询 (并把结果写入文件或 |管道)
  \gset [PREFIX]             执行查询并把结果存到psql变量中
  \h [名称]                  SQL命令语法上的说明，用*显示全部命令的语法说明
  \q             退出 psql
  \watch [SEC]          每隔SEC秒执行一次查询

查询缓存区
  \e [FILE] [LINE]                使用外部编辑器编辑查询缓存区(或文件)
  \ef [FUNCNAME [LINE]]           使用外部编辑器编辑函数定义
  \p                            显示查询缓存区的内容
  \r                            重置(清除)查询缓存区
  \s [文件]                                显示历史记录或将历史记录保存在文件中
  \w 文件                                  将查询缓存区的内容写入文件

输入/输出
  \copy ...             执行 SQL COPY，将数据流发送到客户端主机
  \echo [字符串]       将字符串写到标准输出
  \i 文件          从文件中执行命令
  \ir FILE               与 \i类似, 但是相对于当前脚本的位置
  \o [文件]        将全部查询结果写入文件或 |管道
  \qecho [字符串]      将字符串写到查询输出串流(参考 \o)
资讯性
  (选项: S = 显示系统对象, + = 其余的详细信息)
  \d[S+]          列出表,视图和序列
  \d[S+]  名称      描述表，视图，序列，或索引
  \da[S]  [模式]    列出聚合函数
  \db[+]  [模式]     列出表空间
  \dc[S+] [PATTERN]      列表转换
  \dC[+]  [PATTERN]      列出类型强制转换
  \dd[S]  [PATTERN]      显示没有在别处显示的对象描述
  \ddp     [模式]    列出缺省权限
  \dD[S+] [PATTERN]      列出共同值域
  \det[+] [PATTERN]      列出引用表
  \des[+] [模式]    列出外部服务器
  \deu[+] [模式]     列出用户映射
\dew[+] [模式]       列出外部数据封装器
   \df[antw][S+] [模式]    列出[只包括 聚合/常规/触发器/窗口]函数
  \dF[+]  [模式]   列出文本搜索配置
  \dFd[+] [模式]     列出文本搜寻字典
\dFp[+] [模式]     列出文本搜索解析器
  \dFt[+] [模式]   列出文本搜索模版
  \dg[+]  [PATTERN]      列出角色
\di[S+] [模式]  列出索引
  \dl                   列出大对象， 功能与\lo_list相同
  \dL[S+] [PATTERN]      列出所有过程语言
  \dm[S+] [PATTERN]      列出所有物化视图
  \dn[S+] [PATTERN]     列出所有模式
  \do[S]  [模式]   列出运算符
  \dO[S+] [PATTERN]      列出所有校对规则
  \dp     [模式]     列出表，视图和序列的访问权限
  \drds [模式1 [模式2]] 列出每个数据库的角色设置
  \ds[S+] [模式]    列出序列
  \dt[S+] [模式]     列出表
  \dT[S+] [模式]  列出数据类型
  \du[+]  [PATTERN]      列出角色
  \dv[S+] [模式]   列出视图
  \dE[S+] [PATTERN]      列出引用表
  \dx[+]  [PATTERN]      列出扩展
  \dy     [PATTERN]      列出所有事件触发器
  \l[+]   [PATTERN]      列出所有数据库
\sf[+] FUNCNAME        显示函数定义
  \z      [模式]    和\dp的功能相同

格式化
  \a                  在非对齐模式和对齐模式之间切换
  \C [字符串]        设置表的标题，或如果没有的标题就取消
  \f [字符串]         显示或设定非对齐模式查询输出的字段分隔符
  \H                    切换HTML输出模式 (目前是 关闭)
  \pset NAME [VALUE]     设定表输出选项
                         (NAME := {format|border|expanded|fieldsep|fieldsep_zero|footer|null|
                         numericlocale|recordsep|recordsep_zero|tuples_only|title|tableattr|pager})
  \t [开|关]       只显示记录 (目前是 关闭)
  \T [字符串]         设置HTML &lt;表格&gt;标签属性, 或者如果没有的话取消设置
  \x [on|off|auto]       切换扩展输出模式(目前是 关闭)

连接
  \c[onnect] {[DBNAME|- USER|- HOST|- PORT|-] | conninfo}
                         connect to new database (currently &quot;susemanager&quot;)
  \encoding [编码名称] 显示或设定客户端编码
  \password [USERNAME]  安全地为用户改变口令
  \conninfo              显示当前连接的相关信息

操作系统
  \cd [目录]     改变目前的工作目录
  \setenv NAME [VALUE]   设置或清空环境变量
\timing [开|关]       切换命令计时开关 (目前是 关闭)
  \! [命令]      在 shell中执行命令或启动一个交互式shell

变量
  \prompt [文本] 名称 提示用户设定内部变量
  \set [名称 [值数]] 设定内部变量，若无参数则列出全部变量
  \unset 名称    清空(删除)内部变量

大对象
  \lo_export LOBOID 文件
  \lo_import 文件 [注释]
  \lo_list
  \lo_unlink LOBOID   大对象运算
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br></div></div><h2 id="六、特性"><a href="#六、特性" class="header-anchor">#</a> 六、特性</h2> <h3 id="对-json-的支持"><a href="#对-json-的支持" class="header-anchor">#</a> 对 JSON 的支持</h3> <p>postgresql 支持两种 json 数据类型：json 和 jsonb，而两者唯一的区别在于效率;</p> <p>json 是对输入的完整拷贝，<strong>使用时再去解析</strong>，所以它会保留输入的空格，重复键以及顺序等。而 jsonb 是解析输入后保存的二进制，它在解析时会删除不必要的空格和重复的键，顺序和输入可能也不相同。使用时不用再次解析。两者对重复键的处理都是保留最后一个键值对。效率的差别：<strong>json 类型存储快，使用慢，jsonb 类型存储稍慢，使用较快</strong>。</p> <p><strong>注意：键值对的键必须使用双引号</strong></p> <p>测试表：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> api<span class="token punctuation">(</span>jdoc jsonb<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> api <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'{
  &quot;guid&quot;: &quot;9c36adc1-7fb5-4d5b-83b4-90356a46061a&quot;,
  &quot;name&quot;: &quot;Angela Barton&quot;,
  &quot;is_active&quot;: true,
  &quot;company&quot;: &quot;Magnafone&quot;,
  &quot;address&quot;: &quot;178 Howard Place, Gulf, Washington, 702&quot;,
  &quot;registered&quot;: &quot;2009-11-07T08:53:22 +08:00&quot;,
  &quot;latitude&quot;: 19.793713,
  &quot;longitude&quot;: 86.513373,
  &quot;hobby&quot;: {
      &quot;h1&quot;: &quot;Singing&quot;,
      &quot;h2&quot;: &quot;dancing&quot;
  },
  &quot;tags&quot;: [
    &quot;enim&quot;,
    &quot;aliquip&quot;,
    &quot;qui&quot;
   ]
}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 根据key 获取json中的值</span>
<span class="token keyword">select</span> score<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">'语文'</span> <span class="token keyword">as</span> score <span class="token keyword">from</span> tb_test<span class="token punctuation">;</span>

<span class="token comment">-- #&gt;&gt; 在指定的路径获取JSON对象为 text</span>
<span class="token comment">-- 数组的获取方法: 获取key为tags，下标为1的值</span>
<span class="token keyword">select</span> jdoc<span class="token comment">#&gt;&gt;'{tags, 1}' as tags from api;</span>
<span class="token comment">-- map的获取方法: 获取key为hobby的对象下，key为h2的值</span>
<span class="token keyword">select</span> jdoc<span class="token comment">#&gt;&gt;'{hobby,h2}' from api;</span>

<span class="token comment">-- 获取表中jdoc字段去掉hobby属性后的值（并没有物理删除）</span>
<span class="token keyword">select</span> jdoc<span class="token operator">-</span><span class="token string">'hobby'</span> <span class="token keyword">from</span> api<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>参考文章:<a href="https://www.cnblogs.com/alianbog/p/5658156.html" target="_blank" rel="noopener noreferrer">postgresql----JSON 类型和函数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="序列"><a href="#序列" class="header-anchor">#</a> 序列</h3> <p>自增：</p> <p>postgresql 序列号（SERIAL）类型包括 smrial2(short), smrial4(int), smrial8(long)，<strong>但是序列号类型其实不是真正的类型，当声明一个字段为序列号类型时其实是创建了一个序列</strong>，INSERT 时如果没有给该字段赋值会默认获取对应序列的下一个值。</p> <p>创建表的时候可以设置 id 自增，可以这么写: id int4 (int2 表示两个字节， int4 表示四个字节，int8 表达 8 个字节)</p> <p>使用 SERIAL 时，其实就是使用了 postgresql 内置的序列 tbl_serial_a_seq</p> <p>序列的类型有</p> <p>参考: <a href="https://www.cnblogs.com/xmzzp/p/6290610.html" target="_blank" rel="noopener noreferrer">序列<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="正则表达式查询"><a href="#正则表达式查询" class="header-anchor">#</a> 正则表达式查询</h3> <p>使用关键字 &quot;~&quot;, 如果匹配规则不需要区分大小写，可以使用组合键 &quot;~*&quot;;</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token number">1.</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> email <span class="token operator">~</span> <span class="token string">'^[A-H]'</span> <span class="token comment">--匹配email地址以A-H开头的记录</span>
<span class="token number">2.</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> email <span class="token operator">~</span><span class="token operator">*</span> <span class="token string">'^[a-h]'</span>  <span class="token comment">--匹配email地址以A-H和a-h开头的记录</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>相关正则表达式文章：</p> <p><a href="https://www.cnblogs.com/tsql/p/6386218.html" target="_blank" rel="noopener noreferrer">深入理解正则表达式高级教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://blog.csdn.net/wugewuge/article/details/7704996" target="_blank" rel="noopener noreferrer">原文地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>##七、oracle 与 postgresql 的区别：</p> <p>参考文章:</p> <p>​ <a href="https://blog.csdn.net/pierre_/article/details/52268587" target="_blank" rel="noopener noreferrer">PostgreSQL 与 Oracle 的差异对比<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>​ <a href="http://www.postgres.cn/docs/9.3/plpgsql-porting.html" target="_blank" rel="noopener noreferrer">从 Oracle PL/SQL 进行移植<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="八、数据库迁移"><a href="#八、数据库迁移" class="header-anchor">#</a> 八、数据库迁移</h2> <p>windows 工具: <a href="http://www.bkill.com/download/156828.html" target="_blank" rel="noopener noreferrer">OracleToPostgres<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>linu 文章(Ora2Pg): <a href="https://www.cnblogs.com/lottu/p/9114959.html" target="_blank" rel="noopener noreferrer">Oracle 迁移至 PostgreSQL 工具之 Ora2Pg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="九、postgis"><a href="#九、postgis" class="header-anchor">#</a> 九、postGIS</h2> <p>注意：拥有者需要有创建数据库和 schame 的权限</p> <p><a href="https://blog.csdn.net/qq_35732147/article/details/85228444" target="_blank" rel="noopener noreferrer">加载空间数据<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://blog.csdn.net/qq_35732147/article/details/81169961" target="_blank" rel="noopener noreferrer">PostGIS 的安装与初步使用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="十、pg-简单用法"><a href="#十、pg-简单用法" class="header-anchor">#</a> 十、pg 简单用法</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查看当前登陆用户</span>
<span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token comment">-------------------------------------创建数据-----------------------------------</span>
<span class="token comment">-- 1、创建用户 并设置登陆密码</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">&quot;test&quot;</span> PASSWORD <span class="token string">'123456'</span><span class="token punctuation">;</span>

<span class="token comment">-- 2、创建角色</span>
<span class="token keyword">CREATE</span> ROLE <span class="token string">&quot;test_role&quot;</span> CREATEDB CREATEROLE<span class="token punctuation">;</span>

<span class="token comment">-- 3、给用户设置角色</span>
<span class="token keyword">GRANT</span> <span class="token string">&quot;test_role&quot;</span> <span class="token keyword">to</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

<span class="token comment">-- 4、创建表空间</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> <span class="token string">&quot;test_tbspace&quot;</span> OWNER <span class="token string">&quot;test&quot;</span> LOCATION <span class="token string">'e:\tbspaces'</span><span class="token punctuation">;</span>

<span class="token comment">-- 5、创建数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> testdb OWNER <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span> ENCODING <span class="token operator">=</span> <span class="token string">&quot;UTF-8&quot;</span> <span class="token keyword">TABLESPACE</span> <span class="token operator">=</span> <span class="token string">&quot;test_tbspace&quot;</span><span class="token punctuation">;</span>



<span class="token comment">-- 创建schema  schema一般与用户名一样(在使用表视图等时可以不用写schema，查询也会直接查与用户名相同的schema下的数据)</span>
<span class="token comment">-- 6、创建得shema想要在指定的数据库中，就需要登陆的时候连接那个数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">AUTHORIZATION</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

<span class="token comment">--  查询search_path SET search_path = &quot;$user&quot;, public, myschema;</span>

<span class="token comment">-- 7、创建表  默认在searche_path的第一个shema下(这里一般shema与用户名相同)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span> <span class="token punctuation">(</span>
  <span class="token string">&quot;id&quot;</span> serial4<span class="token punctuation">,</span> <span class="token comment">-- 这里会使用默认序列, 当然可以使用自定义的递增序列</span>
  <span class="token string">&quot;name&quot;</span> <span class="token keyword">varchar</span> <span class="token keyword">COLLATE</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;age&quot;</span> int4<span class="token punctuation">,</span>
  <span class="token string">&quot;gender&quot;</span> int4<span class="token punctuation">,</span>
  <span class="token string">&quot;score&quot;</span> jsonb<span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;pk_test.tb_est&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">WITH</span> <span class="token punctuation">(</span>OIDS<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>

<span class="token comment">-- 设置表的拥有着，默认是当前登陆用户</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span> OWNER <span class="token keyword">TO</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">COMMENT</span> <span class="token keyword">ON</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span> <span class="token operator">IS</span> <span class="token string">'测试表'</span><span class="token punctuation">;</span>
<span class="token keyword">COMMENT</span> <span class="token keyword">ON</span> <span class="token keyword">COLUMN</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span> <span class="token operator">IS</span> <span class="token string">'用户id'</span><span class="token punctuation">;</span>
<span class="token keyword">COMMENT</span> <span class="token keyword">ON</span> <span class="token keyword">COLUMN</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;name&quot;</span> <span class="token operator">IS</span> <span class="token string">'姓名'</span><span class="token punctuation">;</span>
<span class="token keyword">COMMENT</span> <span class="token keyword">ON</span> <span class="token keyword">COLUMN</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;age&quot;</span> <span class="token operator">IS</span> <span class="token string">'年龄'</span><span class="token punctuation">;</span>
<span class="token keyword">COMMENT</span> <span class="token keyword">ON</span> <span class="token keyword">COLUMN</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;gender&quot;</span> <span class="token operator">IS</span> <span class="token string">'性别'</span><span class="token punctuation">;</span>

<span class="token comment">-- 8、添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;tb_test&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'qiao'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'{&quot;数学&quot;: &quot;100&quot;, &quot;语文&quot;: &quot;100&quot;}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">------------------------------------删除数据-----------------------------------------</span>

<span class="token comment">-- 级联删除schema（删除schema下的表，视图，过程，触发器等）,需要有权限</span>
<span class="token keyword">DROP</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除数据库 需要有权限</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;testdb&quot;</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除表空间 表空间没有数据可删</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLESPACE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test_tbspace&quot;</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除角色</span>
<span class="token keyword">DROP</span> ROLE <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test_role&quot;</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除用户</span>
<span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div></div> <div class="content edit-link"><a href="http://elb-791125809.cn-northwest-1.elb.amazonaws.com.cn:5335/edit/master/docs/doc-backend/database/PostgreSQL.md" target="_blank" rel="noopener noreferrer">
      编辑此页面
    </a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="content page-nav"><p class="inner"><span class="prev"><a href="/doc-backend/database/windowsmongoaq.html" class="prev">&lt; windows版mongo启动安全认证</a></span> <!----></p></div> <div class="footer">数据中心 研发二部</div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.16cdc938.js" defer></script><script src="/assets/js/3.4f14b16d.js" defer></script><script src="/assets/js/1.02cf7ae9.js" defer></script><script src="/assets/js/32.6baff7b9.js" defer></script>
  </body>
</html>
