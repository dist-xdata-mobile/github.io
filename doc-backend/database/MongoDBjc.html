<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB基础 | Fellow Travellers</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <meta name="description" content="Fellow-Travellers documents for tech3D / mobile / calc / back-end">
    <link rel="preload" href="/assets/css/0.styles.d4a3a82a.css" as="style"><link rel="preload" href="/assets/js/app.16cdc938.js" as="script"><link rel="preload" href="/assets/js/3.4f14b16d.js" as="script"><link rel="preload" href="/assets/js/1.02cf7ae9.js" as="script"><link rel="preload" href="/assets/js/27.b95d8356.js" as="script"><link rel="prefetch" href="/assets/js/10.f5269c4e.js"><link rel="prefetch" href="/assets/js/100.c7e247ff.js"><link rel="prefetch" href="/assets/js/101.b60225bc.js"><link rel="prefetch" href="/assets/js/102.adacab9e.js"><link rel="prefetch" href="/assets/js/103.32cd0f3b.js"><link rel="prefetch" href="/assets/js/104.1fd9ea1d.js"><link rel="prefetch" href="/assets/js/105.5bfce959.js"><link rel="prefetch" href="/assets/js/106.44ca9c1d.js"><link rel="prefetch" href="/assets/js/107.9ee3fdbe.js"><link rel="prefetch" href="/assets/js/108.2e6ba386.js"><link rel="prefetch" href="/assets/js/109.12b4497c.js"><link rel="prefetch" href="/assets/js/11.9161989f.js"><link rel="prefetch" href="/assets/js/110.d255fdda.js"><link rel="prefetch" href="/assets/js/111.64c62930.js"><link rel="prefetch" href="/assets/js/112.6a427f04.js"><link rel="prefetch" href="/assets/js/113.5ec41ed5.js"><link rel="prefetch" href="/assets/js/114.d289af71.js"><link rel="prefetch" href="/assets/js/115.b052778b.js"><link rel="prefetch" href="/assets/js/116.f20d5acd.js"><link rel="prefetch" href="/assets/js/117.759b608c.js"><link rel="prefetch" href="/assets/js/118.a00460b4.js"><link rel="prefetch" href="/assets/js/119.021cbb12.js"><link rel="prefetch" href="/assets/js/12.e1aacb47.js"><link rel="prefetch" href="/assets/js/120.5bd8b71f.js"><link rel="prefetch" href="/assets/js/121.3e722ff2.js"><link rel="prefetch" href="/assets/js/122.a825e6c4.js"><link rel="prefetch" href="/assets/js/123.ff402ce6.js"><link rel="prefetch" href="/assets/js/124.287761b7.js"><link rel="prefetch" href="/assets/js/125.b4048370.js"><link rel="prefetch" href="/assets/js/126.bef086fd.js"><link rel="prefetch" href="/assets/js/127.a0784eab.js"><link rel="prefetch" href="/assets/js/128.66f3cbc1.js"><link rel="prefetch" href="/assets/js/129.aef33c57.js"><link rel="prefetch" href="/assets/js/13.faee7a70.js"><link rel="prefetch" href="/assets/js/130.0fbb1019.js"><link rel="prefetch" href="/assets/js/131.61f2146b.js"><link rel="prefetch" href="/assets/js/132.3d912bd8.js"><link rel="prefetch" href="/assets/js/133.b688ed34.js"><link rel="prefetch" href="/assets/js/134.59d26e48.js"><link rel="prefetch" href="/assets/js/135.2d1de6ca.js"><link rel="prefetch" href="/assets/js/136.82c509c1.js"><link rel="prefetch" href="/assets/js/137.aa6f5b18.js"><link rel="prefetch" href="/assets/js/138.8f50bb93.js"><link rel="prefetch" href="/assets/js/139.83f80acb.js"><link rel="prefetch" href="/assets/js/14.5e1b322f.js"><link rel="prefetch" href="/assets/js/140.255a8042.js"><link rel="prefetch" href="/assets/js/141.a7ad537d.js"><link rel="prefetch" href="/assets/js/142.b0c92d9c.js"><link rel="prefetch" href="/assets/js/143.f15b1f80.js"><link rel="prefetch" href="/assets/js/144.813a5a2e.js"><link rel="prefetch" href="/assets/js/145.b7069ddf.js"><link rel="prefetch" href="/assets/js/146.9fcc40e8.js"><link rel="prefetch" href="/assets/js/147.654c12e8.js"><link rel="prefetch" href="/assets/js/148.d2104b86.js"><link rel="prefetch" href="/assets/js/149.16115bff.js"><link rel="prefetch" href="/assets/js/15.c64a0296.js"><link rel="prefetch" href="/assets/js/150.e19d3aa4.js"><link rel="prefetch" href="/assets/js/151.e1e9732d.js"><link rel="prefetch" href="/assets/js/152.e4d9ed7c.js"><link rel="prefetch" href="/assets/js/153.720bddec.js"><link rel="prefetch" href="/assets/js/154.6d76f159.js"><link rel="prefetch" href="/assets/js/155.56639bb5.js"><link rel="prefetch" href="/assets/js/156.1b1456ad.js"><link rel="prefetch" href="/assets/js/157.41735b3f.js"><link rel="prefetch" href="/assets/js/158.2f7e2a71.js"><link rel="prefetch" href="/assets/js/159.8ecf5123.js"><link rel="prefetch" href="/assets/js/16.f13c1a4b.js"><link rel="prefetch" href="/assets/js/160.dd6f3d5e.js"><link rel="prefetch" href="/assets/js/161.ba4d9a7f.js"><link rel="prefetch" href="/assets/js/162.297aea0d.js"><link rel="prefetch" href="/assets/js/163.e34450b7.js"><link rel="prefetch" href="/assets/js/164.34381886.js"><link rel="prefetch" href="/assets/js/165.d4c2775d.js"><link rel="prefetch" href="/assets/js/166.c4c9cefb.js"><link rel="prefetch" href="/assets/js/167.d323a0a9.js"><link rel="prefetch" href="/assets/js/168.c20012b9.js"><link rel="prefetch" href="/assets/js/169.3cfddb83.js"><link rel="prefetch" href="/assets/js/17.e99ac461.js"><link rel="prefetch" href="/assets/js/170.3d3526f6.js"><link rel="prefetch" href="/assets/js/171.bba7cce9.js"><link rel="prefetch" href="/assets/js/172.8fbda3bd.js"><link rel="prefetch" href="/assets/js/173.1532f8d6.js"><link rel="prefetch" href="/assets/js/174.638e5e0a.js"><link rel="prefetch" href="/assets/js/175.d8d82e12.js"><link rel="prefetch" href="/assets/js/176.4b3a122c.js"><link rel="prefetch" href="/assets/js/177.3d9e6e89.js"><link rel="prefetch" href="/assets/js/178.58b1bf9b.js"><link rel="prefetch" href="/assets/js/179.3fc5f21a.js"><link rel="prefetch" href="/assets/js/18.2df0d7da.js"><link rel="prefetch" href="/assets/js/180.436cb2b1.js"><link rel="prefetch" href="/assets/js/181.dadcbdd8.js"><link rel="prefetch" href="/assets/js/182.d7f00bd5.js"><link rel="prefetch" href="/assets/js/183.b6a49ebe.js"><link rel="prefetch" href="/assets/js/184.72f1e1df.js"><link rel="prefetch" href="/assets/js/185.a30e0b04.js"><link rel="prefetch" href="/assets/js/186.a89aa666.js"><link rel="prefetch" href="/assets/js/187.c7601a79.js"><link rel="prefetch" href="/assets/js/188.47d25cdd.js"><link rel="prefetch" href="/assets/js/189.a5220877.js"><link rel="prefetch" href="/assets/js/19.74c2fe85.js"><link rel="prefetch" href="/assets/js/190.7fea63c8.js"><link rel="prefetch" href="/assets/js/191.79188b69.js"><link rel="prefetch" href="/assets/js/192.91858bc5.js"><link rel="prefetch" href="/assets/js/193.f8c9dc11.js"><link rel="prefetch" href="/assets/js/194.db5d514f.js"><link rel="prefetch" href="/assets/js/195.a21dfa21.js"><link rel="prefetch" href="/assets/js/196.3deca662.js"><link rel="prefetch" href="/assets/js/197.a26c6a57.js"><link rel="prefetch" href="/assets/js/198.199de2a9.js"><link rel="prefetch" href="/assets/js/199.3a93f5fd.js"><link rel="prefetch" href="/assets/js/20.37ef7b5a.js"><link rel="prefetch" href="/assets/js/200.2e0ca284.js"><link rel="prefetch" href="/assets/js/201.43159287.js"><link rel="prefetch" href="/assets/js/202.47ac18b9.js"><link rel="prefetch" href="/assets/js/21.8edf360c.js"><link rel="prefetch" href="/assets/js/22.681f9ff8.js"><link rel="prefetch" href="/assets/js/23.102f38f3.js"><link rel="prefetch" href="/assets/js/24.0d068097.js"><link rel="prefetch" href="/assets/js/25.b8c6fba0.js"><link rel="prefetch" href="/assets/js/26.b76fcccf.js"><link rel="prefetch" href="/assets/js/28.425d53a0.js"><link rel="prefetch" href="/assets/js/29.49ae4d56.js"><link rel="prefetch" href="/assets/js/30.268326de.js"><link rel="prefetch" href="/assets/js/31.d1322ccd.js"><link rel="prefetch" href="/assets/js/32.6baff7b9.js"><link rel="prefetch" href="/assets/js/33.91599495.js"><link rel="prefetch" href="/assets/js/34.7d1e8694.js"><link rel="prefetch" href="/assets/js/35.a28b2867.js"><link rel="prefetch" href="/assets/js/36.926c21b7.js"><link rel="prefetch" href="/assets/js/37.00738964.js"><link rel="prefetch" href="/assets/js/38.c07a024e.js"><link rel="prefetch" href="/assets/js/39.23ab4214.js"><link rel="prefetch" href="/assets/js/4.79366a86.js"><link rel="prefetch" href="/assets/js/40.47c89362.js"><link rel="prefetch" href="/assets/js/41.0e9b77b3.js"><link rel="prefetch" href="/assets/js/42.e93c36a9.js"><link rel="prefetch" href="/assets/js/43.8e4bef73.js"><link rel="prefetch" href="/assets/js/44.f5808021.js"><link rel="prefetch" href="/assets/js/45.3afe2dae.js"><link rel="prefetch" href="/assets/js/46.f597a77f.js"><link rel="prefetch" href="/assets/js/47.11f2d487.js"><link rel="prefetch" href="/assets/js/48.7fef6ef8.js"><link rel="prefetch" href="/assets/js/49.b2d21efe.js"><link rel="prefetch" href="/assets/js/5.9ee91412.js"><link rel="prefetch" href="/assets/js/50.5832583c.js"><link rel="prefetch" href="/assets/js/51.54c00e7a.js"><link rel="prefetch" href="/assets/js/52.bd5535f0.js"><link rel="prefetch" href="/assets/js/53.0d38f84a.js"><link rel="prefetch" href="/assets/js/54.65144b95.js"><link rel="prefetch" href="/assets/js/55.368817a9.js"><link rel="prefetch" href="/assets/js/56.04e15523.js"><link rel="prefetch" href="/assets/js/57.b41a7dc6.js"><link rel="prefetch" href="/assets/js/58.0f0d92dd.js"><link rel="prefetch" href="/assets/js/59.e7dddc9e.js"><link rel="prefetch" href="/assets/js/6.b921ef33.js"><link rel="prefetch" href="/assets/js/60.4038bd0b.js"><link rel="prefetch" href="/assets/js/61.5d51e956.js"><link rel="prefetch" href="/assets/js/62.786b095c.js"><link rel="prefetch" href="/assets/js/63.9da19a49.js"><link rel="prefetch" href="/assets/js/64.48f50f07.js"><link rel="prefetch" href="/assets/js/65.0fd7ee4a.js"><link rel="prefetch" href="/assets/js/66.5d68a363.js"><link rel="prefetch" href="/assets/js/67.f4882da2.js"><link rel="prefetch" href="/assets/js/68.224daefc.js"><link rel="prefetch" href="/assets/js/69.420801b1.js"><link rel="prefetch" href="/assets/js/7.e128bbee.js"><link rel="prefetch" href="/assets/js/70.1e62f96f.js"><link rel="prefetch" href="/assets/js/71.62f9fa7c.js"><link rel="prefetch" href="/assets/js/72.ad20df74.js"><link rel="prefetch" href="/assets/js/73.e16fef7c.js"><link rel="prefetch" href="/assets/js/74.c1f72d12.js"><link rel="prefetch" href="/assets/js/75.e1f28980.js"><link rel="prefetch" href="/assets/js/76.2c304c87.js"><link rel="prefetch" href="/assets/js/77.7265d1f0.js"><link rel="prefetch" href="/assets/js/78.c7c2fdd3.js"><link rel="prefetch" href="/assets/js/79.0be55b5d.js"><link rel="prefetch" href="/assets/js/8.b17d0b27.js"><link rel="prefetch" href="/assets/js/80.3c460019.js"><link rel="prefetch" href="/assets/js/81.972b58cd.js"><link rel="prefetch" href="/assets/js/82.6c4d50e0.js"><link rel="prefetch" href="/assets/js/83.89ff3b39.js"><link rel="prefetch" href="/assets/js/84.5629cfb0.js"><link rel="prefetch" href="/assets/js/85.78a9bc3f.js"><link rel="prefetch" href="/assets/js/86.b429e7fb.js"><link rel="prefetch" href="/assets/js/87.5c3ba926.js"><link rel="prefetch" href="/assets/js/88.52737753.js"><link rel="prefetch" href="/assets/js/89.696bb63f.js"><link rel="prefetch" href="/assets/js/9.0874a43d.js"><link rel="prefetch" href="/assets/js/90.60296dbe.js"><link rel="prefetch" href="/assets/js/91.2d2fd4df.js"><link rel="prefetch" href="/assets/js/92.d860f080.js"><link rel="prefetch" href="/assets/js/93.b341ebd9.js"><link rel="prefetch" href="/assets/js/94.ebd37258.js"><link rel="prefetch" href="/assets/js/95.15dbfc06.js"><link rel="prefetch" href="/assets/js/96.041d049b.js"><link rel="prefetch" href="/assets/js/97.e22ed305.js"><link rel="prefetch" href="/assets/js/98.2e23ad42.js"><link rel="prefetch" href="/assets/js/99.e886cd85.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4a3a82a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar shadow"><div class="con-btns-header"><a href="/" class="home-link router-link-active"><div class="con-logo"><!----> <span class="site-name">Fellow Travellers</span></div></a> <div class="links"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link" data-v-e7cf42d2>主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">三维</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-tech3d/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/language/Micro-frontend_Start.html" class="nav-link" data-v-e7cf42d2>开发语言</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/production/" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/codelab/Principle_of_Visualizatio_for_WebGL.html" class="nav-link" data-v-e7cf42d2>专题</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/other/SuperMap_Questions_and_Answer.html" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-frontend/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/base/EC_ScopChain_Closure.html" class="nav-link" data-v-e7cf42d2>开发基础</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/web-gis/" class="nav-link" data-v-e7cf42d2>WebGIS开发</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/solution/" class="nav-link" data-v-e7cf42d2>解决方案</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/best-practice/" class="nav-link" data-v-e7cf42d2>最佳实践</a></li><li class="dropdown-item"><!----> <a href="/doc-frontend/arithmetic/QuickSort.html" class="nav-link" data-v-e7cf42d2>算法</a></li><li class="dropdown-item"><!----> <a href="/doc-tech3d/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">移动</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-mobile/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/dataResource/sourceCodeLib.html" class="nav-link" data-v-e7cf42d2>数据资源</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/product/nativeApp.html" class="nav-link" data-v-e7cf42d2>产品分型</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/appStore/" class="nav-link" data-v-e7cf42d2>应用商店</a></li><li class="dropdown-item"><!----> <a href="/doc-mobile/other/designDocument.html" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-calc3d/start/XinShouShouCe.html" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/gis/Base_ZBX_ZongJie.html" class="nav-link" data-v-e7cf42d2>GIS</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/database/Oracle_LostSysPassword.html" class="nav-link" data-v-e7cf42d2>数据库</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/language/" class="nav-link" data-v-e7cf42d2>开发语言</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/codelab/" class="nav-link" data-v-e7cf42d2>源码库</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/production/DDP_ArcGIS_BuShuShouCe.html" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-calc3d/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后台</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-backend/start/" class="nav-link" data-v-e7cf42d2>入门手册</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/database/Mongoazyx.html" class="nav-link" data-v-e7cf42d2>数据库</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/framework/Git.html" class="nav-link" data-v-e7cf42d2>开发基础</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/production/" class="nav-link" data-v-e7cf42d2>产品</a></li><li class="dropdown-item"><!----> <a href="/doc-backend/other/" class="nav-link" data-v-e7cf42d2>其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础研发</span></a> <ul class="nav-dropdown"><li class="dropdown-item"><!----> <a href="/doc-base/dist-utils/API.html" class="nav-link" data-v-e7cf42d2>dist-utils</a></li><li class="dropdown-item"><!----> <a href="http://192.168.200.39:18088/EyeMapAPI/" target="_blank" rel="noopener noreferrer" class="nav-link" data-v-e7cf42d2>eyemap业务库</a></li><li class="dropdown-item"><!----> <a href="/doc-base/stylelint-config/" class="nav-link" data-v-e7cf42d2>stylelint-config</a></li></ul></div></div><div class="nav-item"><a href="/doc-share/SuperMap_Pipe3DStrategy.html" class="nav-link" data-v-e7cf42d2>分享</a></div><div class="nav-item"><a href="https://fellowtravellers.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link" data-v-e7cf42d2>社区</a></div><div class="nav-item"><a href="/doc-help/mdRule.html" class="nav-link" data-v-e7cf42d2>帮助</a></div></nav></div></div> <div class="con-redes-download"><a title="GitLab" href="http://elb-791125809.cn-northwest-1.elb.amazonaws.com.cn:5335/" target="_blank" rel="noopener noreferrer" class="repo-link flaticon-github"></a></div></header> <div class="sidebar-map"><div class="c-sidebar-map"><ul class="sidebar-links-map"><li><div class="sidebar-group first"><ul class="sidebar-group-items"><li><a href="/doc-backend/database/Mongoazyx.html" class="sidebar-link siderbar-map-item">Mongo安装运行</a></li><li><a href="/doc-backend/database/Mongoccwj.html" class="sidebar-link siderbar-map-item">Mongo存储文件—GridFS</a></li><li><a href="/doc-backend/database/MongoDBjc.html" aria-current="page" class="active sidebar-link siderbar-map-item">MongoDB基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-backend/database/MongoDBjc.html#简介" class="sidebar-link siderbar-map-item">简介</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/MongoDBjc.html#基本操作-crud" class="sidebar-link siderbar-map-item">基本操作 CRUD</a></li></ul></li><li><a href="/doc-backend/database/MongoDBsy.html" class="sidebar-link siderbar-map-item">MongoDB权限操作</a></li><li><a href="/doc-backend/database/MongoDBzstx.html" class="sidebar-link siderbar-map-item">MongoDB知识体系</a></li><li><a href="/doc-backend/database/springBootMongodb.html" class="sidebar-link siderbar-map-item">Spring-boot对Mongo的操作</a></li><li><a href="/doc-backend/database/windowsmongoaq.html" class="sidebar-link siderbar-map-item">windows版mongo启动安全认证</a></li></ul></div></li><li><div class="sidebar-group"><ul class="sidebar-group-items"><li><a href="/doc-backend/database/PostgreSQL.html" class="sidebar-link siderbar-map-item">PostgreSQL</a></li></ul></div></li></ul> </div></div> <div class="sidebar"><div class="c-sidebar"> <div class="search-box"><input aria-label="Search" placeholder="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Mango</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc-backend/database/Mongoazyx.html" class="sidebar-link">Mongo安装运行</a></li><li><a href="/doc-backend/database/Mongoccwj.html" class="sidebar-link">Mongo存储文件—GridFS</a></li><li><a href="/doc-backend/database/MongoDBjc.html" aria-current="page" class="active sidebar-link">MongoDB基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc-backend/database/MongoDBjc.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/doc-backend/database/MongoDBjc.html#基本操作-crud" class="sidebar-link">基本操作 CRUD</a></li></ul></li><li><a href="/doc-backend/database/MongoDBsy.html" class="sidebar-link">MongoDB权限操作</a></li><li><a href="/doc-backend/database/MongoDBzstx.html" class="sidebar-link">MongoDB知识体系</a></li><li><a href="/doc-backend/database/springBootMongodb.html" class="sidebar-link">Spring-boot对Mongo的操作</a></li><li><a href="/doc-backend/database/windowsmongoaq.html" class="sidebar-link">windows版mongo启动安全认证</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>PostgreSQL</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc-backend/database/PostgreSQL.html" class="sidebar-link">PostgreSQL</a></li></ul></div></li></ul> </div></div> <!----> <!----> <div class="page"><div class="content-pagex content content__default"><h1 id="mongodb-基础"><a href="#mongodb-基础" class="header-anchor">#</a> MongoDB 基础</h1> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <ul><li>存储文档的非关系型数据库
<ul><li>使用文档的好处是：
<ul><li>文档（即对象）对应于许多编程语言中的本机数据类型。</li> <li>嵌入式文档和数组减少了对昂贵连接的需求。</li> <li>动态模式支持流畅的多态性。</li></ul></li></ul></li></ul> <h3 id="数据库结构"><a href="#数据库结构" class="header-anchor">#</a> 数据库结构</h3> <p><img src="C:%5CUsers%5Cxiaohao%5CDocuments%5CNotes%5Cimg%5Cmongo%E7%BB%93%E6%9E%84.png" alt="mongo结构"></p> <h3 id="主要特点"><a href="#主要特点" class="header-anchor">#</a> 主要特点</h3> <ul><li><p>高性能</p> <p>MongoDB 提供高性能数据持久性。特别是，</p> <ul><li>对嵌入式数据模型的支持减少了数据库系统的 I / O 活动。</li> <li>索引支持更快的查询，并且可以包含来自嵌入式文档和数组的键。</li></ul></li> <li><p>丰富的查询语言</p> <p>MongoDB 支持丰富的查询语言以支持[读写操作（CRUD）以及：</p> <ul><li>数据聚合</li> <li>文本搜索和地理空间查询。</li></ul></li> <li><p>高可用性</p> <p>MongoDB 的复制工具称为副本集，它提供：</p> <ul><li><em>自动</em>故障转移</li> <li>数据冗余。</li></ul> <p>副本集是一组保持相同的数据集，从而提供冗余和提高数据可用性的 MongoDB 服务器。</p></li> <li><p>水平可伸缩性</p> <p>MongoDB 提供水平可伸缩性作为其<em>核心</em> 功能的一部分：</p> <ul><li>分片在一组计算机集群分布数据。</li> <li>从 3.4 开始，MongoDB 支持基于分片键创建数据区域。在平衡群集中，MongoDB 仅将区域覆盖的读取和写入指向区域内的分片。</li></ul></li> <li><p>支持多个存储引擎</p> <p>MongoDB 支持多个存储引擎：</p> <ul><li>WiredTiger 存储引擎（包括对静态加密的支持 ）</li> <li>内存存储引擎</li></ul></li></ul> <p>此外，MongoDB 提供可插拔存储引擎 API，允许第三方为 MongoDB 开发存储引擎。</p> <h3 id="使用-docker-容器运行-mongodb"><a href="#使用-docker-容器运行-mongodb" class="header-anchor">#</a> 使用 docker 容器运行 MongoDB</h3> <ul><li><p>下载 MongoDB 的官方 docker 镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker pull mongo:4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看下载的镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>启动一个 MongoDB 服务器容器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker run --name mymongo -v /mymongo/data:/data/db -d mongo:4
<span class="token comment">##以后可以直接启动mymongo容器</span>
docker start mymongo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>查看 docker 容器状态</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看数据库服务器日志</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker logs mymongo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h3 id="mongo-express"><a href="#mongo-express" class="header-anchor">#</a> Mongo Express</h3> <blockquote><p>是一个基于网络的 MongoDB 数据库管理界面</p></blockquote> <ul><li><p>下载 mongo-express 镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker pull mongo-express
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>运行 mongo-express</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker run --link mymongo:mongo -p <span class="token number">8081</span>:8081 mongo-express
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问数据库</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>localhost:8081
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h3 id="mongo-shell"><a href="#mongo-shell" class="header-anchor">#</a> mongo shell</h3> <blockquote><p>mongo shell 是用来操作 MongoDB 的 JavaScript 客户端界面</p></blockquote> <ul><li><p>运行 mongo shell</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker <span class="token builtin class-name">exec</span> -it mymongo mongo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>支持 JavaScript 语法</p></li></ul> <h2 id="基本操作-crud"><a href="#基本操作-crud" class="header-anchor">#</a> 基本操作 CRUD</h2> <p>https://mws.mongodb.com/?version=4.0</p> <ul><li><p>文档主键_id</p> <ul><li><p>文档主键的唯一性</p></li> <li><p>支持所有的数据类型（数组除外）</p></li> <li><p>复合主键，（文档作为文档主键）</p> <p>???文档作为主键时文档内容顺序是否影响文档的唯一性</p></li></ul></li> <li><p>默认对象主键 ObjectId</p> <ul><li>快速生成 12 字节的 id</li></ul></li> <li><p>包含创建时间</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#获取创建时间</span>
<span class="token operator">&gt;</span>ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5d5bd2854b18eb4e7922e52e&quot;</span><span class="token punctuation">)</span>.getTimestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>
ISODate<span class="token punctuation">(</span><span class="token string">&quot;2019-08-20T10:59:17Z&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>使用 mongo shell 操作数据库</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>use <span class="token builtin class-name">test</span> <span class="token comment">#使用test数据库</span>
show collections <span class="token comment">#查看数据库中的集合</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h3 id="c"><a href="#c" class="header-anchor">#</a> C</h3> <h4 id="db-collection-insertone"><a href="#db-collection-insertone" class="header-anchor">#</a> db.collection.insertOne()</h4> <ul><li><p>插入集合一条数据</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.insertOne<span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
	<span class="token punctuation">{</span>
		writeConcern:<span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>不存在集合可自动创建集合</li> <li>writeConcren 文档定义了本次文档创建操作的安全写级别
<ul><li>安全写级别用来判断一次数据库写入操作是否成功</li> <li>安全写级别越高，丢失风险就越低，然而写入操作的延迟可能就更高。</li> <li>不提供该文档，mongoDB 使用默认的安全写级别</li></ul></li></ul></li> <li><p>举例</p> <ul><li><p>将文档写入到 demo 集合中</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.insertOne<span class="token punctuation">(</span>
	<span class="token punctuation">{</span>
		_id:<span class="token string">&quot;demo1&quot;</span>,
		name:<span class="token string">&quot;zs&quot;</span>,
		age:21
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li> <li><p>返回值</p> <ul><li><p>正确返回值</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true, <span class="token string">&quot;insertedId&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;demo1&quot;</span> <span class="token punctuation">}</span>
<span class="token comment">#acknowledged：安全写级别是否被启动</span>
<span class="token comment">#insertedId：文档主键</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>错误返回值</p> <p>插入一条重复主键的文档，返回的信息较多，可以采用 try catch 方式进行定位异常</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>try<span class="token punctuation">{</span>
	db.demo.insertOne<span class="token punctuation">(</span>
		<span class="token punctuation">{</span>
			_id:<span class="token string">&quot;demo1&quot;</span>,
			name:<span class="token string">&quot;zss&quot;</span>,
			age:22
		<span class="token punctuation">}</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>catch<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
	print<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>返回值：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>WriteError<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string">&quot;index&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;code&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11000</span>,
	<span class="token string">&quot;errmsg&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;E11000 duplicate key error collection: test.demo index: _id_ dup key: { _id: <span class="token entity" title="\&quot;">\&quot;</span>demo1<span class="token entity" title="\&quot;">\&quot;</span> }&quot;</span>,
	<span class="token string">&quot;op&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
		<span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;demo1&quot;</span>,
		<span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zss&quot;</span>,
		<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">22</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li></ul> <h4 id="db-collection-insertmany"><a href="#db-collection-insertmany" class="header-anchor">#</a> db.collection.insertMany()</h4> <ul><li><p>创建多个文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.insertMany<span class="token punctuation">(</span>
	<span class="token punctuation">[</span><span class="token operator">&lt;</span>document<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token operator">&lt;</span>document<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">]</span>,
<span class="token punctuation">{</span>
		writeConcren:<span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
		ordered:<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>ordered 参数决定 mongoDB 是否要按顺序来写入这些文档
<ul><li>参数为 false，可以打乱文档的写入顺序，可以优化写入操作的性能</li> <li>参数默认值为 true</li></ul></li></ul></li> <li><p>举例</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		name:<span class="token string">&quot;qq&quot;</span>,
		age:12
	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span>
		name:<span class="token string">&quot;ww&quot;</span>,
		age:33
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>返回值</p> <ul><li><p>正确返回值</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
	<span class="token string">&quot;acknowledged&quot;</span> <span class="token builtin class-name">:</span> true,
	<span class="token string">&quot;insertedIds&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5d5bc9b94b18eb4e7922e526&quot;</span><span class="token punctuation">)</span>,
		ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5d5bc9b94b18eb4e7922e527&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>错误返回值</p> <p>其中一条带有重复主键</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>try<span class="token punctuation">{</span>
	db.demo.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		_id:<span class="token string">&quot;demo1&quot;</span>,
		name:<span class="token string">&quot;qq&quot;</span>,
		age:12
	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span>
		name:<span class="token string">&quot;ww&quot;</span>,
		age:33
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>catch<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
	print<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>返回：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>BulkWriteError<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string">&quot;writeErrors&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token string">&quot;index&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
			<span class="token string">&quot;code&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">11000</span>,
			<span class="token string">&quot;errmsg&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;E11000 duplicate key error collection: test.demo index: _id_ dup key: { _id: <span class="token entity" title="\&quot;">\&quot;</span>demo1<span class="token entity" title="\&quot;">\&quot;</span> }&quot;</span>,
			<span class="token string">&quot;op&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
				<span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;demo1&quot;</span>,
				<span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;qq&quot;</span>,
				<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">12</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>,
	<span class="token string">&quot;writeConcernErrors&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>,
	<span class="token string">&quot;nInserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;nRemoved&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">&quot;upserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li><p>nInserted 代表成功插入的条数</p> <p>？？？正序插入和乱序插入的成功插入条数一样嘛</p> <p>？？？正序插入后面文档出错，前面文档会被写入嘛</p></li></ul></li></ul></li></ul> <h4 id="db-collection-insert"><a href="#db-collection-insert" class="header-anchor">#</a> db.collection.insert()</h4> <ul><li><p>创建单个或多个文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.insert<span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>document or array of document<span class="token operator">&gt;</span>,
	<span class="token punctuation">{</span>
		writeConcren:<span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>,
		ordered:<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>返回值</p> <ul><li><p>正确返回，</p> <p>返回成功写入文档的数量等等</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;nInserted&quot;</span>:1<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>错误返回</p> <p>和上个类似</p></li></ul></li></ul> <h4 id="db-collection-save"><a href="#db-collection-save" class="header-anchor">#</a> db.collection.save()</h4> <ul><li>db.collection.save 命令处理一个新文档的时候，他会调用 db.collection.insert()命令</li> <li>举例返回结果文档和 db.collection.insert()命令相同</li> <li>区别
<ul><li>新增的数据中已存在主键，则再次插入相同的主键时 insert() 会提示错误，而 save() 则更改原来的内容为新内容。</li> <li>insert 可以一次性插入一个列表，而不用遍历，效率高， save 则需要遍历列表，一个个插入。</li></ul></li></ul> <h4 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h4> <ul><li>返回数据信息不同</li> <li>insertOne 和 insertMany 命令不支持 db.collection.explain()命令</li> <li>insert 支持 db.collection.explain()命令</li></ul> <h3 id="r"><a href="#r" class="header-anchor">#</a> R</h3> <h4 id="db-collection-find"><a href="#db-collection-find" class="header-anchor">#</a> db.collection.find()</h4> <ul><li><p>结构</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.find<span class="token punctuation">(</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>,<span class="token operator">&lt;</span>projection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>query 文档定义了读取操作时筛选文档的条件</li> <li>projection 文档定义了对读取结果进行的投射</li></ul></li> <li><p>读取全部文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.collection.find<span class="token punctuation">(</span><span class="token punctuation">)</span>
db.collection.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">#更清晰的显示文档</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h4 id="匹配查询"><a href="#匹配查询" class="header-anchor">#</a> 匹配查询</h4> <ul><li><p>读取 zs 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">&quot;zs&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5d5bc9b94b18eb4e7922e526&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <ul><li><p>可以匹配多个条件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">&quot;zs&quot;</span>,age:12<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>匹配复合主键时，可以直接_id.复合主键的字段。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>_id.***:<span class="token string">&quot;内容&quot;</span>  <span class="token comment">###***代表复合主键中的某一字段</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h4 id="比较操作符"><a href="#比较操作符" class="header-anchor">#</a> 比较操作符</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> $<span class="token operator">&lt;</span>operator<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>$eq 匹配字段值相等的文档</p></li> <li><p>$ne 匹配字段值不等的文档</p> <blockquote><p>注：会筛选出并不包含查询字段的文档（匹配 age 不等于 18，没有 age 这个字段的文档也会匹配出来）</p></blockquote></li> <li><p>$gt 匹配字段值大于查询值的文档</p></li> <li><p>$gte 匹配字段值大于或等于查询值的文档</p></li> <li><p>$lt 匹配字段值小于查询值的文档</p></li> <li><p>$lte 匹配字段值小于或等于查询值的文档</p></li> <li><p>举例</p> <ul><li><p>读取 zs 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token punctuation">{</span><span class="token variable">$eq</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>读取不属于 zs 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token punctuation">{</span><span class="token variable">$ne</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>读取年龄大于 18 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age: <span class="token punctuation">{</span><span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">18</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>$in 匹配字段值与任意查询值相等的文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>field: <span class="token punctuation">{</span> <span class="token variable">$in</span>:<span class="token punctuation">[</span><span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>读取 zs 和 ww 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token punctuation">{</span><span class="token variable">$in</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;zs&quot;</span>,<span class="token string">&quot;ww&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>$nin 匹配字段值与任何查询值都不相等的文档</p> <ul><li>读取除了 zs 和 ww 的个人信息</li></ul></li></ul> <h4 id="逻辑操作符"><a href="#逻辑操作符" class="header-anchor">#</a> 逻辑操作符</h4> <ul><li><p>$not</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> <span class="token variable">$not</span> :<span class="token punctuation">{</span> <span class="token operator">&lt;</span>operator-expression<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>读取年龄不小于 18 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span> age: <span class="token punctuation">{</span> <span class="token variable">$not</span> :<span class="token punctuation">{</span><span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">18</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>$and</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$and</span> :<span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>读取年龄大于 18 并且用户姓名排在 zs 之后的用户文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token variable">$and</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span> age: <span class="token punctuation">{</span> <span class="token variable">$gt</span>:18 <span class="token punctuation">}</span> <span class="token punctuation">}</span>,
		<span class="token punctuation">{</span> name: <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span><span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>当筛选条件应用在不同字段上时，可以省略$and 操作符</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
		 age: <span class="token punctuation">{</span> <span class="token variable">$gt</span>:18 <span class="token punctuation">}</span> ,
		 name: <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span><span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>当筛选条件应用在同一字段上时，也可以省略$and 操作符</p> <ul><li><p>读取年龄大于 18 并且小于 30 的个人信息文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
		 age: <span class="token punctuation">{</span> <span class="token variable">$gt</span>:18 ,<span class="token variable">$lt</span>:30<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li></ul></li> <li><p>$or</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$or</span> :<span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>读取 zs 或者 ww 的个人信息文档</li> <li>不可省略</li></ul></li> <li><p>$nor</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$nor</span> :<span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token operator">&lt;</span>expression<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>读取不属于 zs 和 ww 并且年龄不小于 18 的个人信息文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token variable">$nor</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span> name:<span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
		<span class="token punctuation">{</span> name:<span class="token string">&quot;ww&quot;</span> <span class="token punctuation">}</span>,
		<span class="token punctuation">{</span> age: <span class="token punctuation">{</span> <span class="token variable">$lt</span>:18 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>$nor 也会筛选出并不包含查询字段的文档</p></li></ul></li></ul> <h4 id="字段操作符"><a href="#字段操作符" class="header-anchor">#</a> 字段操作符</h4> <ul><li><p>$exists 匹配包含查询字段的文档（可以解决 ne 和 nor 精确匹配问题）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>field: <span class="token punctuation">{</span> <span class="token variable">$exists</span> :<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>读取包含电话字段的个人信息文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> phone: <span class="token punctuation">{</span> <span class="token variable">$exists</span> :true <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>可以解决 ne 和 nor 精确匹配问题</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token punctuation">{</span><span class="token variable">$ne</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span> ,<span class="token variable">$exists</span> :true<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>$type 匹配字段类型符合查询值的文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>field: <span class="token punctuation">{</span> <span class="token variable">$type</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>BSON type<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span>field: <span class="token punctuation">{</span> <span class="token variable">$type</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>BSON type<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token operator">&lt;</span>BSON type<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>读取文档主键是字符串的文档主键</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> _id: <span class="token punctuation">{</span> <span class="token variable">$type</span> <span class="token builtin class-name">:</span><span class="token string">&quot;string&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>读取用户姓名是 null 的银行账户文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> name: <span class="token punctuation">{</span> <span class="token variable">$type</span> <span class="token builtin class-name">:</span><span class="token string">&quot;null&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>使用对应的 BSON 类型序号作为$type 操作符和参数</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> _id: <span class="token punctuation">{</span> <span class="token variable">$type</span> :2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>  <span class="token comment">#2代表字符串</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li></ul> <h4 id="数组操作符"><a href="#数组操作符" class="header-anchor">#</a> 数组操作符</h4> <ul><li><p>$all 匹配数组字段中包含所有查询值的文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>field<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> <span class="token variable">$all</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>, <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>$elemMatch 匹配数组字段中至少存在一个值满足筛选条件的文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>field<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> <span class="token variable">$elemMatch</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>query<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>, <span class="token operator">&lt;</span>query<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h4 id="运算操作符"><a href="#运算操作符" class="header-anchor">#</a> 运算操作符</h4> <ul><li><p>regex 匹配满足正则表达式的文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>field<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> <span class="token builtin class-name">:</span> /pattern/, <span class="token builtin class-name">:</span><span class="token string">'&lt;options&gt;'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>   <span class="token comment">#常用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>field<span class="token operator">&gt;</span>: <span class="token punctuation">{</span> <span class="token builtin class-name">:</span> /pattern/<span class="token operator">&lt;</span>options<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>     <span class="token comment">#和$in一起</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>在和$in 操作符一起使用的时，只能使用第二种</p></li> <li><p>读取用户姓名以 c 开头或者 j 开头的用户文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span> name:<span class="token punctuation">{</span><span class="token variable">$in</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> /^c/, /^j/ <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>读取用户姓名包含 LIE（不区分大小写）的用户文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> name: <span class="token punctuation">{</span> <span class="token variable">$regex</span>:/LIE/, <span class="token variable">$options</span><span class="token builtin class-name">:</span><span class="token string">'i'</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li></ul> <h4 id="文档游标"><a href="#文档游标" class="header-anchor">#</a> 文档游标</h4> <ul><li><p>db.collection.find() 返回的一个文档集合游标</p> <ul><li><p>在不迭代游标的情况下，只列出前 20 个文档</p></li> <li><p>我们可以使用游标下标直接访问文档集合中某一个文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>var myCursor <span class="token operator">=</span> db.demo.find<span class="token punctuation">(</span><span class="token punctuation">)</span>
myCursor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>游历完游标中所有的文档之后，或者在 10 分钟之后，游标会自动关闭</p></li> <li><p>可以使用 noCursorTimeout()函数来保持游标一直有效</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>var myCursor <span class="token operator">=</span> db.demo.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.noCursorTimeout<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>在这之后，在不遍历游标的情况之后，你需要主动关闭游标</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>myCursor.close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>游标函数</p> <ul><li>cursor.hasNext() 是否有下一个文档</li> <li>cursor.Next() 指向下一个文档</li> <li>cursor.forEach()</li> <li>cursor.limit()
<ul><li>传入数字，只返回多少文档</li> <li>？？？？limit(0) 不使用</li></ul></li> <li>cursor.skip()
<ul><li>传入数字，跳过多少文档</li> <li>永远在 limit()之前执行</li></ul></li> <li>cursor.count()</li> <li>cursor.sort()
<ul><li>永远在 skip()和 limit()函数之前执行</li></ul></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>var myCursor <span class="token operator">=</span> db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">&quot;zs&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 while<span class="token punctuation">(</span>myCursor.hasNext<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{</span>
 	printjson<span class="token punctuation">(</span>myCursor.next<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h4 id="文档投影"><a href="#文档投影" class="header-anchor">#</a> 文档投影</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.collection.find<span class="token punctuation">(</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>,<span class="token operator">&lt;</span>projection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>不使用投影时，返回完整的文档信息</p></li> <li><p>使用文档时，可以有选择性的返回文档中的部分字段</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>filed: inclusion <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>1 表示返回的字段，0 表示不返回的字段</p></li> <li><p>只返回用户文档中的用户姓名</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span> name:1 <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>只返回用户文档中的用户姓名（不包含文档主键）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span> name:1, _id: <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>除了文档主键之外，我们不可以在投影文档中混合使用包含和不包含这两种投影操作</p> <ul><li>要么列出所有应该包含的字段，要么列出所有不应该包含的字段，不然会报错。</li></ul></li> <li><p>在数组字段上使用投影</p> <ul><li><p>$slice 操作符可以返回数组字段中的部分元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span> _id: <span class="token number">0</span>, name:1, contact:<span class="token punctuation">{</span><span class="token variable">$slice</span><span class="token builtin class-name">:</span> <span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>contact 数组字段只返回第一个元素</p></li> <li><p>-1 代表返回最后一个</p></li> <li><p>[1,2]跳过第一个元素，返回之后 的两个元素</p></li></ul></li> <li><p>也可以使用$eleMatch 对数组字段进行筛选</p></li> <li><p>如果 find 的筛选条件和数组内字段的筛选条件相同可以直接使用数组字段.$</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.find<span class="token punctuation">(</span>
	<span class="token punctuation">{</span>contact:<span class="token punctuation">{</span><span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> _id: <span class="token number">0</span>, name: <span class="token number">1</span>, <span class="token string">&quot;contact.$&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li></ul> <h3 id="u"><a href="#u" class="header-anchor">#</a> U</h3> <h4 id="db-collection-update"><a href="#db-collection-update" class="header-anchor">#</a> db.collection.update()</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.update<span class="token punctuation">(</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>update<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>options<span class="token operator">&gt;</span><span class="token punctuation">)</span>

<span class="token comment">##&lt;query&gt;文档定义筛选条件和.find()条件相同</span>
<span class="token comment">##&lt;update&gt;文档定义了做什么样的更新</span>
<span class="token comment">##&lt;options&gt;文档声明了一些更新操作的参数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="整篇更新文档"><a href="#整篇更新文档" class="header-anchor">#</a> 整篇更新文档</h5> <blockquote><p>update 里提供整篇文档</p></blockquote> <ul><li><p>举例</p> <ul><li><p>查询 zs 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.demo.find<span class="token punctuation">(</span><span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;demo1&quot;</span>, <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zs&quot;</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">21</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>将 zs 的年龄改为 23</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.demo.update<span class="token punctuation">(</span> <span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span>, age: <span class="token number">23</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>, <span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">##nMatched&quot; : 1   代表有一个符合查询的结果</span>
<span class="token comment">##nModified&quot; : 1  代表有一个完成更新</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li> <li><p>文档主键_id 是不可以更改的</p></li> <li><p>在使用 update 文档<strong>替换整篇</strong>被更新的文档时，只有<strong>第一篇</strong>符合 query 文档筛选条件的文档才会被更新</p> <ul><li>假如整篇更新年龄大于 18 少于 20 的文档，如果有两篇，但也只会更新第一篇</li></ul></li> <li><p>更新整篇文档只能应用于单一文档上</p></li></ul> <h5 id="更新特定字段"><a href="#更新特定字段" class="header-anchor">#</a> 更新特定字段</h5> <blockquote><p>如果 update 文档只包含更新操作符，update 将会更新集合中符合筛选条件的特定字段</p></blockquote> <p>文档更新操作符</p> <ul><li><p>$set 更新或者新增字段</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$set</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>更新 ww 的年龄和增加其他信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;ww&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$set</span><span class="token builtin class-name">:</span>
		<span class="token punctuation">{</span>
			age: <span class="token number">24</span>,
			info: <span class="token punctuation">{</span>
				createTime: new Date<span class="token punctuation">(</span><span class="token string">&quot;2016-05-18T16:00Z&quot;</span><span class="token punctuation">)</span>,
				branch: <span class="token string">&quot;branch1&quot;</span>
			<span class="token punctuation">}</span>,
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>内嵌文档更新</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$set</span>:<span class="token punctuation">{</span>
	<span class="token string">&quot;info.branch&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;new branch&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>数组内字段更新</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$set</span>:<span class="token punctuation">{</span>
	<span class="token string">&quot;contact.3&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;new contact&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>如果下标跳过原长度进行更新，也会更新成功，中间未被赋值用 null 进行补充</li></ul></li></ul></li> <li><p>$unset 删除字段</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;ww&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$unset</span><span class="token builtin class-name">:</span>
		<span class="token punctuation">{</span>
			age: <span class="token string">&quot;&quot;</span>,
			<span class="token string">&quot;info.branch&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>age:&quot;&quot;引号内可以填写任何内容，都会被删除</li> <li>删除数组元素时，长度不会被改变，被删除的位置会变为 null</li></ul></li> <li><p>$rename 重命名字段</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$rename</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>newName<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>, <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>: <span class="token operator">&lt;</span>newName<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>如果新的字段名已经存在，那么原有的这个字段会被覆盖</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;qq&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$rename</span><span class="token builtin class-name">:</span>
		<span class="token punctuation">{</span>
			<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;name&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">#原先的name会被覆盖掉，现在的name等于以前的age值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>可以将内嵌文档和外层的文档移动位置，，数组不可以</p></li></ul></li> <li><p>$inc 加减字段值</p></li> <li><p>$mul 相乘字段值</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$inc</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>amount<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token variable">$mul</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>amount<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>更新 zs 的年龄</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$inc</span><span class="token builtin class-name">:</span>
		<span class="token punctuation">{</span>
			age:-1
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>两种运算操作符只能操作数字类型字段</p></li> <li><p>如果被操作的字段不存在时</p> <ul><li>$inc 会创建字段，并将字段值设置为命令中的增减值</li> <li>$mul 会创建字段，但是字段值会设为 0</li></ul></li></ul></li> <li><p>$min 比较保留最小的字段值</p></li> <li><p>$max 比较保留最大的字段值</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$min</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token variable">$max</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$min</span><span class="token builtin class-name">:</span>
		<span class="token punctuation">{</span>
			age:18
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">#age比18大就更新为18,保留最小的值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><p>如果更新字段不存在，两种命令会创建该字段，并且将该字段值设为命令中的更新值</p></li> <li><p>如果被更新字段类型和更新值类型不一致，命令会按照 BSON 数据类型的排序规则进行比较</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#最小</span>
Null
Numbers <span class="token punctuation">(</span>ints, longs, doubles<span class="token punctuation">)</span>
Symbol, String
Object
Array
BinData
ObjectID
Boolean
Date, Timestamp
<span class="token comment">#最大</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul></li></ul> <h5 id="数组更新操作符"><a href="#数组更新操作符" class="header-anchor">#</a> 数组更新操作符</h5> <ul><li><p>$addToSet 向数组中增添元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$addToSet</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>添加文档数组中的元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$addToSet</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>contact: <span class="token string">&quot;China&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">#contact为文档中的数组元素，为该数组添加一个元素</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>如果数组中已经存在，不会进行更新</p> <ul><li>如果数组中存在内嵌文档，内嵌文档中的元素顺序和内容完全一样才算已存在</li></ul></li> <li><p>将数组插入被更新的数组中，会成为内嵌数组</p> <ul><li><p>如果想将数组中元素，直接插入到数组中可以使用$each 操作符</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$addToSet</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>contact: <span class="token punctuation">{</span><span class="token variable">$each</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;contact1&quot;</span>,<span class="token string">&quot;contact2&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment">###contact1和contact2会直接插入到contact数组中，不会成为内嵌数组</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul></li> <li><p>$pop 从数组中移除元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$pop</span>  <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>-1 <span class="token operator">|</span> <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span> <span class="token punctuation">}</span>  <span class="token comment">#最后1，开始-1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>只能删除第一个或者最后一个元素</p></li> <li><p>删除数组字段中最后一个元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$pop</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>contact: <span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>如果数组元素都被删除，空数组也会被保留下来</p></li></ul></li> <li><p>$pull 从数组中有选择性的移除元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$pull</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value <span class="token operator">|</span> condition<span class="token operator">&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>可以删除特定位置的数组</p></li> <li><p>删除一数组字段中包含“hi”字母的元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;zs&quot;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$pull</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> contact: <span class="token punctuation">{</span> <span class="token variable">$regex</span><span class="token builtin class-name">:</span> /hi/ <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>匹配内嵌数组元素时，可以使用$elemMatch 操作符进行匹配</p></li> <li><p>删除内嵌文档时，只要部分字段匹配，即可删除该内嵌文档，只要形成包含关系，顺序也无关</p></li></ul></li> <li><p>$pullAll 从数组中有选择性的移除元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$pullAll</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token punctuation">[</span><span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>参数为一个数组，可以删除多个元素</li> <li>删除内嵌文档时，必须顺序和内容完全一样</li></ul></li> <li><p>$push 向数组中增添元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token variable">$push</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>filed<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>: <span class="token operator">&lt;</span>value<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>可以添加重复元素</p></li> <li><p>可以和$each 搭配使用</p></li> <li><p>可以和$position 操作符搭配使用，从当前位置开始操作</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;lawrence&quot;</span>	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$push</span>:<span class="token punctuation">{</span>
		<span class="token string">&quot;newArray&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
				<span class="token variable">$each</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pos1&quot;</span>, <span class="token string">&quot;pos2&quot;</span><span class="token punctuation">]</span>,
				<span class="token variable">$position</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>可以和$sort 操作符搭配使用，一定要搭配 push 和 each 操作符使用</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;lawrence&quot;</span>	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$push</span>:<span class="token punctuation">{</span>
		<span class="token string">&quot;newArray&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
				<span class="token variable">$each</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;sort&quot;</span><span class="token punctuation">]</span>,
				<span class="token variable">$sort</span><span class="token builtin class-name">:</span> <span class="token number">1</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li><p>插入之后排序，sort 的值为 1 时为正序排序，-1 为倒序排序</p></li> <li><p>有内嵌文档时，可以指定字段进行排序</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$sort</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>value: <span class="token number">1</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>不插入元素，只进行排序</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;lawrence&quot;</span>	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$push</span>:<span class="token punctuation">{</span>
		<span class="token string">&quot;newArray&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
				<span class="token variable">$each</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
				<span class="token variable">$sort</span><span class="token builtin class-name">:</span> <span class="token number">1</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li> <li><p>可以搭配$slice 来截取部分数组，一定要搭配 push 和 each 操作符使用</p> <ul><li><p>插入元素之后，截取数组后八位元素</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;lawrence&quot;</span>	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$push</span>:<span class="token punctuation">{</span>
		<span class="token string">&quot;newArray&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
				<span class="token variable">$each</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;slice1&quot;</span><span class="token punctuation">]</span>,
				<span class="token variable">$slice</span><span class="token builtin class-name">:</span> -8
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul></li> <li><p>position，sort，slice 操作符可以一起使用</p> <ul><li>执行顺序为 position，sort，slice</li> <li>写命令的顺序，并不影响命令的执行顺序</li></ul></li></ul></li> <li><p>数组占位符</p> <ul><li><p>$</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> <span class="token operator">&lt;</span>array<span class="token operator">&gt;</span>: <span class="token operator">&lt;</span>query selector<span class="token operator">&gt;</span> <span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token operator">&lt;</span>upadate operator<span class="token operator">&gt;</span>: <span class="token punctuation">{</span><span class="token string">&quot;&lt;array&gt;.$&quot;</span><span class="token builtin class-name">:</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>在有数组筛选条件而不确定数组下标的时候，可以使用$占位符</p></li> <li><p>$是数组中<strong>第一个</strong>符合筛选条件的数组元素的占位符</p></li> <li><p>举例</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
	<span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;ww&quot;</span>,
	<span class="token string">&quot;newArray&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;push1&quot;</span>,
		<span class="token string">&quot;push2&quot;</span>,
		<span class="token string">&quot;push3&quot;</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token operator">&gt;</span>db.collection.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span> name: <span class="token string">&quot;lawrence&quot;</span>,
	  newArray: <span class="token string">&quot;push3&quot;</span>
	<span class="token punctuation">}</span>,
	<span class="token punctuation">{</span> <span class="token variable">$set</span>:<span class="token punctuation">{</span>
		<span class="token string">&quot;newArray.$&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;updated&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">###可以将数组中的push3更新为updated</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li> <li><p>$[]</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span> <span class="token operator">&lt;</span>upadate operator<span class="token operator">&gt;</span>: <span class="token punctuation">{</span><span class="token string">&quot;&lt;array&gt;.$[]&quot;</span><span class="token builtin class-name">:</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>更新数组中所有元素</li> <li>$[]指代数组字段中所有元素</li></ul></li></ul></li></ul> <h5 id="options-选项"><a href="#options-选项" class="header-anchor">#</a> options 选项</h5> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>multi: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>更新多个文档</p></li> <li><p>update 命令使用的筛选条件只对应于一篇文档，</p></li> <li><p>在默认情况下，即使筛选条件对应了多篇文档，update 命令仍然只会更新第<strong>一篇</strong>文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.update<span class="token punctuation">(</span>
	<span class="token punctuation">{</span><span class="token punctuation">}</span>,   <span class="token comment">#匹配所有文档</span>
	<span class="token punctuation">{</span> <span class="token variable">$set</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
		currency: <span class="token string">&quot;USD&quot;</span>
		<span class="token punctuation">}</span>,
	<span class="token punctuation">}</span>
	<span class="token punctuation">{</span>mulit: <span class="token boolean">true</span> <span class="token punctuation">}</span>   <span class="token comment">#不加该选项则只会更新第一篇文档</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>更新多个文档操作不能保证其文档的原子性，更新多个文档时中途可能被其他线程挂起，以防止一个进程霸占数据库资源，</p> <ul><li>如果要保证，需要引入 mongodb4.0 版本的事务功能</li></ul></li></ul></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>upsert: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>更新或者创建文档</li> <li>在默认情况下，如果 update 命令中筛选条件没有匹配任何文档，则不会进行任何操作</li> <li>upsert 为 true 时，如果 update 命令中的筛选条件没有匹配任何文档，则会创建新文档</li> <li>如果无法从筛选条件中推断出确定的字段值，新创建的文档将不会包含筛选条件涉及的字段，比如筛选条件是一个不等式</li></ul></li> <li></li></ul> <h4 id="db-collection-findandmodify"><a href="#db-collection-findandmodify" class="header-anchor">#</a> db.collection.findAndModify()</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.findAndModify<span class="token punctuation">(</span><span class="token operator">&lt;</span>docunment<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>方法用于修改和返回单个文档。默认情况下，返回的文档不包括对更新所做的修改。</li></ul> <h4 id="db-collection-save-2"><a href="#db-collection-save-2" class="header-anchor">#</a> db.collection.save()</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.save<span class="token punctuation">(</span><span class="token operator">&lt;</span>docunment<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>如果 document 文档中包含了_id 子弹，save()命令将会调用 db.collection.update() 命令 ，并且（upsert: true）</li></ul> <h3 id="d"><a href="#d" class="header-anchor">#</a> D</h3> <h4 id="db-collection-remove"><a href="#db-collection-remove" class="header-anchor">#</a> db.collection.remove()</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.remove<span class="token punctuation">(</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>,<span class="token operator">&lt;</span>options<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>删除特定文档</p></li> <li><p>删除年龄为 18 的个人信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span>db.demo.remove<span class="token punctuation">(</span><span class="token punctuation">{</span>age: <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nRemoved&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>默认情况下，删除所有筛选条件 文档</p></li> <li><p>如果指向删除第一项符合筛选条件的文档可以使用 justOne 选项</p></li> <li><p>删除集合内所有文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.demo.remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h4 id="db-collection-drop"><a href="#db-collection-drop" class="header-anchor">#</a> db.collection.drop()</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>db.<span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>.drop<span class="token punctuation">(</span> <span class="token punctuation">{</span> writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">#writeConcern定义了本次集合删除操作的安全写级别，可省略为默认</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>删除整个集合，包含所有集合，以及集合的索引</li> <li>效率较高</li></ul></div> <div class="content edit-link"><a href="http://elb-791125809.cn-northwest-1.elb.amazonaws.com.cn:5335/edit/master/docs/doc-backend/database/MongoDBjc.md" target="_blank" rel="noopener noreferrer">
      编辑此页面
    </a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="content page-nav"><p class="inner"><span class="prev"><a href="/doc-backend/database/Mongoccwj.html" class="prev">&lt; Mongo存储文件—GridFS</a></span> <span class="next"><a href="/doc-backend/database/MongoDBsy.html">
          MongoDB权限操作
          &gt;
        </a></span></p></div> <div class="footer">数据中心 研发二部</div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.16cdc938.js" defer></script><script src="/assets/js/3.4f14b16d.js" defer></script><script src="/assets/js/1.02cf7ae9.js" defer></script><script src="/assets/js/27.b95d8356.js" defer></script>
  </body>
</html>
